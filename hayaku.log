# Logfile created on 2014-08-22 17:17:27 -0700 by logger.rb/31641
E, [2014-08-25T10:13:49.276540 #78741] ERROR -- : Error running ssh deploy_info command:  INFO] Response from scheduler: OK (message: None)
Traceback (most recent call last):
  File "/Users/yhua/.tools-cache/home/aurora/tools/client/libexec/aurora-client/twitter/common/app/application.py", line 738, in _wrap_method
    return_code = method()
  File "/Users/yhua/.tools-cache/home/aurora/tools/client/libexec/aurora-client/twitter/common/app/application.py", line 760, in <lambda>
    main = lambda: main_method(*args, **kwargs)
  File "/Users/yhua/.tools-cache/home/aurora/tools/client/libexec/aurora-client/.deps/apache.aurora.clientv2-0.5.1_DEV1406838503-py2.6.egg/apache/aurora/client/commands/ssh.py", line 54, in ssh
    first_task = resp.result.scheduleStatusResult.tasks[0]
IndexError: list index out of range

I, [2014-08-25T10:13:49.276895 #78741]  INFO -- : Changeset is nil
I, [2014-08-25T10:13:49.283900 #78741]  INFO -- : Changeset: 
I, [2014-08-25T10:13:49.963050 #78741]  INFO -- : 
I, [2014-08-25T10:13:49.963260 #78741]  INFO -- : Cloning into '/var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140825-78741-1cm97j6/git_root'...

I, [2014-08-25T10:13:49.980082 #78741]  INFO -- : 
I, [2014-08-25T10:13:49.980272 #78741]  INFO -- : 
I, [2014-08-25T10:13:49.981408 #78741]  INFO -- : Downloading your gems via Spitball server spitball.local.twitter.com...
I, [2014-08-25T10:13:52.312325 #78741]  INFO -- : 
I, [2014-08-25T10:13:52.312736 #78741]  INFO -- : 
I, [2014-08-25T10:13:52.328005 #78741]  INFO -- : /var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140825-78741-1cm97j6/uiTestLeaderboard/config.mesos
I, [2014-08-25T10:13:52.330737 #78741]  INFO -- : # Generated by hayaku v3.13.4

import os

# Note: Packer.install inherits role from the job that runs it, and version's default is 'live'.

# Fetch dependencies
get_application = Packer.install('uiTestLeaderboard', version='latest')
get_ruby_1_9 = Packer.install('ruby-1_9_3-p484_shar', role = 'translate', version = 'live')
get_ruby_2_0 = Packer.install('ruby-2_0_0-p481_shar', role = 'translate', version = 'live')
get_ruby_2_1 = Packer.install('ruby-2_1_2_shar', role = 'translate', version = 'live')
get_nodejs = Packer.install('nodejs', role='mesos')
get_nginx = Packer.install('nginx_1_3_14', role = 'trix', version = 'latest')

mysql = Packer.install('mysql-5_5_23_t6_1', role = 'translate', version = 'live')

env = {"IS_MESOS":"1","GEM_HOME":"`pwd`/ruby_vendor/ruby/1.9.1/","LD_LIBRARY_PATH":"`pwd`/mysql/lib","PATH":"`pwd`/node_js/usr/local/bin:/opt/local/bin/:$PATH","RAILS_ENV":"production","RACK_ENV":"production","rvm_path":"./rvm"}


ruby_announcer = Process(
  name = 'ruby_announcer',
  cmdline = """/bin/bash ./run_ruby_announcer.sh announce sdzookeeper.local.twitter.com:2181/twitter/service/hayaku/devel/uiTestLeaderboard {{mesos.instance}} HOST_NAME:{{thermos.ports[http]}} '{"aurora":"HOST_NAME:{{thermos.ports[http]}}","http":"HOST_NAME:{{thermos.ports[http]}}","health":"HOST_NAME:{{thermos.ports[http]}}"}' -u hayaku:hayaku""",
  daemon = True,
  max_failures = 100,
  ephemeral = True
)


run_uiTestLeaderboard = Process(
  name = 'run_uiTestLeaderboard',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 604800 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"web\"')
)


run_uiTestLeaderboard_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


run_uiTestLeaderboard_scheduler = Process(
  name = 'run_uiTestLeaderboard_scheduler',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 604800 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"scheduler\"')
)


run_uiTestLeaderboard_scheduler_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard_scheduler],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard_scheduler),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


update_config = UpdateConfig(
  batch_size = 1,
  restart_threshold = (60 + 10 * 6 + 2),
  watch_secs = (60 + 10 * 6 + 1)
)

health_config = HealthCheckConfig(
  initial_interval_secs=60,
  interval_secs = 10,
  timeout_secs = 10,
  max_consecutive_failures = 6
)

health_announcer = Announcer(
  portmap = {
    'health':'http',
    'aurora':'http'
  }
)

jobs = [
  Job(
    cluster='smf1',
    role='hayaku',
    service=True,
    task=run_uiTestLeaderboard_task,
    name='uiTestLeaderboard',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
  , Job(
    cluster='smf1',
    role='hayaku',
    service=True,
    task=run_uiTestLeaderboard_scheduler_task,
    name='uiTestLeaderboard_scheduler',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
]

I, [2014-08-25T10:14:19.084789 #78741]  INFO -- : 
I, [2014-08-25T10:14:19.084953 #78741]  INFO -- : Writing log files to disk in /var/tmp
FATAL] Request failed: yhua is not authorized to act as role hayaku: com.twitter.common_internal.security.auth.OdsAuthenticator$OdsAuthFailedException: Authentication failed for yhua (status: 401 - Unauthorized)

E, [2014-08-25T10:32:15.323856 #78913] ERROR -- : Error running ssh deploy_info command:  INFO] Response from scheduler: OK (message: None)
Traceback (most recent call last):
  File "/Users/yhua/.tools-cache/home/aurora/tools/client/libexec/aurora-client/twitter/common/app/application.py", line 738, in _wrap_method
    return_code = method()
  File "/Users/yhua/.tools-cache/home/aurora/tools/client/libexec/aurora-client/twitter/common/app/application.py", line 760, in <lambda>
    main = lambda: main_method(*args, **kwargs)
  File "/Users/yhua/.tools-cache/home/aurora/tools/client/libexec/aurora-client/.deps/apache.aurora.clientv2-0.5.1_DEV1406838503-py2.6.egg/apache/aurora/client/commands/ssh.py", line 54, in ssh
    first_task = resp.result.scheduleStatusResult.tasks[0]
IndexError: list index out of range

I, [2014-08-25T10:32:15.324273 #78913]  INFO -- : Changeset is nil
I, [2014-08-25T10:32:15.335234 #78913]  INFO -- : Changeset: 
I, [2014-08-25T10:32:16.041399 #78913]  INFO -- : 
I, [2014-08-25T10:32:16.041611 #78913]  INFO -- : Cloning into '/var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140825-78913-1pg6nl7/git_root'...

I, [2014-08-25T10:32:16.055442 #78913]  INFO -- : 
I, [2014-08-25T10:32:16.055605 #78913]  INFO -- : 
I, [2014-08-25T10:32:16.056125 #78913]  INFO -- : Downloading your gems via Spitball server spitball.local.twitter.com...
I, [2014-08-25T10:32:16.782087 #78913]  INFO -- : 
I, [2014-08-25T10:32:16.782283 #78913]  INFO -- : 
I, [2014-08-25T10:32:16.793155 #78913]  INFO -- : /var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140825-78913-1pg6nl7/uiTestLeaderboard/config.mesos
I, [2014-08-25T10:32:16.794971 #78913]  INFO -- : # Generated by hayaku v3.13.4

import os

# Note: Packer.install inherits role from the job that runs it, and version's default is 'live'.

# Fetch dependencies
get_application = Packer.install('uiTestLeaderboard', version='latest')
get_ruby_1_9 = Packer.install('ruby-1_9_3-p484_shar', role = 'translate', version = 'live')
get_ruby_2_0 = Packer.install('ruby-2_0_0-p481_shar', role = 'translate', version = 'live')
get_ruby_2_1 = Packer.install('ruby-2_1_2_shar', role = 'translate', version = 'live')
get_nodejs = Packer.install('nodejs', role='mesos')
get_nginx = Packer.install('nginx_1_3_14', role = 'trix', version = 'latest')

mysql = Packer.install('mysql-5_5_23_t6_1', role = 'translate', version = 'live')

env = {"IS_MESOS":"1","GEM_HOME":"`pwd`/ruby_vendor/ruby/1.9.1/","LD_LIBRARY_PATH":"`pwd`/mysql/lib","PATH":"`pwd`/node_js/usr/local/bin:/opt/local/bin/:$PATH","RAILS_ENV":"production","RACK_ENV":"production","rvm_path":"./rvm"}


ruby_announcer = Process(
  name = 'ruby_announcer',
  cmdline = """/bin/bash ./run_ruby_announcer.sh announce sdzookeeper.local.twitter.com:2181/twitter/service/yhua/devel/uiTestLeaderboard {{mesos.instance}} HOST_NAME:{{thermos.ports[http]}} '{"aurora":"HOST_NAME:{{thermos.ports[http]}}","http":"HOST_NAME:{{thermos.ports[http]}}","health":"HOST_NAME:{{thermos.ports[http]}}"}' -u yhua:yhua""",
  daemon = True,
  max_failures = 100,
  ephemeral = True
)


run_uiTestLeaderboard = Process(
  name = 'run_uiTestLeaderboard',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"web\"')
)


run_uiTestLeaderboard_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


run_uiTestLeaderboard_scheduler = Process(
  name = 'run_uiTestLeaderboard_scheduler',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"scheduler\"')
)


run_uiTestLeaderboard_scheduler_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard_scheduler],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard_scheduler),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


update_config = UpdateConfig(
  batch_size = 1,
  restart_threshold = (60 + 10 * 6 + 2),
  watch_secs = (60 + 10 * 6 + 1)
)

health_config = HealthCheckConfig(
  initial_interval_secs=60,
  interval_secs = 10,
  timeout_secs = 10,
  max_consecutive_failures = 6
)

health_announcer = Announcer(
  portmap = {
    'health':'http',
    'aurora':'http'
  }
)

jobs = [
  Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uiTestLeaderboard_task,
    name='uiTestLeaderboard',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
  , Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uiTestLeaderboard_scheduler_task,
    name='uiTestLeaderboard_scheduler',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
]

I, [2014-08-25T10:32:33.677631 #78913]  INFO -- : Package added:
Version: 1
History:
  moved to state PRESENT by yhua on 08/25/2014 17:32:32 UTC

I, [2014-08-25T10:32:33.677876 #78913]  INFO -- : Writing log files to disk in /var/tmp

I, [2014-08-25T10:32:46.203177 #78913]  INFO -- : 
I, [2014-08-25T10:32:46.203429 #78913]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uiTestLeaderboard_scheduler
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-25T10:32:46.391329 #78913]  INFO -- : 
I, [2014-08-25T10:32:46.391534 #78913]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uiTestLeaderboard
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-25T10:33:07.455727 #78913]  INFO -- : 
I, [2014-08-25T10:33:07.456046 #78913]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uiTestLeaderboard_scheduler
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package yhua/uiTestLeaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uiTestLeaderboard_scheduler
 INFO] Retrieving jobs for role yhua
 INFO] No active tasks found for job smf1/yhua/devel/uiTestLeaderboard_scheduler. Creating new job
 INFO] Creating job uiTestLeaderboard_scheduler
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uiTestLeaderboard_scheduler

I, [2014-08-25T10:33:07.810748 #78913]  INFO -- : 
I, [2014-08-25T10:33:07.810898 #78913]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uiTestLeaderboard
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package yhua/uiTestLeaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uiTestLeaderboard
 INFO] Retrieving jobs for role yhua
 INFO] No active tasks found for job smf1/yhua/devel/uiTestLeaderboard. Creating new job
 INFO] Creating job uiTestLeaderboard
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uiTestLeaderboard

I, [2014-08-25T10:33:07.817992 #78913]  INFO -- : App: uiTestLeaderboard production branch: master succesfully deployed to http://uiTestLeaderboard.devel.yhua.service.smf1.twitter.com
I, [2014-08-25T13:11:01.002719 #81867]  INFO -- : Changeset: 
I, [2014-08-25T13:11:01.514121 #81867]  INFO -- : 
I, [2014-08-25T13:11:01.514268 #81867]  INFO -- : Cloning into '/var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140825-81867-yszqtu/git_root'...

I, [2014-08-25T13:11:01.527439 #81867]  INFO -- : 
I, [2014-08-25T13:11:01.527606 #81867]  INFO -- : 
I, [2014-08-25T13:11:01.528095 #81867]  INFO -- : Downloading your gems via Spitball server spitball.local.twitter.com...
I, [2014-08-25T13:11:02.276655 #81867]  INFO -- : 
I, [2014-08-25T13:11:02.276984 #81867]  INFO -- : 
I, [2014-08-25T13:11:02.286248 #81867]  INFO -- : /var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140825-81867-yszqtu/uiTestLeaderboard/config.mesos
I, [2014-08-25T13:11:02.288836 #81867]  INFO -- : # Generated by hayaku v3.13.4

import os

# Note: Packer.install inherits role from the job that runs it, and version's default is 'live'.

# Fetch dependencies
get_application = Packer.install('uiTestLeaderboard', version='latest')
get_ruby_1_9 = Packer.install('ruby-1_9_3-p484_shar', role = 'translate', version = 'live')
get_ruby_2_0 = Packer.install('ruby-2_0_0-p481_shar', role = 'translate', version = 'live')
get_ruby_2_1 = Packer.install('ruby-2_1_2_shar', role = 'translate', version = 'live')
get_nodejs = Packer.install('nodejs', role='mesos')
get_nginx = Packer.install('nginx_1_3_14', role = 'trix', version = 'latest')

mysql = Packer.install('mysql-5_5_23_t6_1', role = 'translate', version = 'live')

env = {"IS_MESOS":"1","GEM_HOME":"`pwd`/ruby_vendor/ruby/1.9.1/","LD_LIBRARY_PATH":"`pwd`/mysql/lib","PATH":"`pwd`/node_js/usr/local/bin:/opt/local/bin/:$PATH","RAILS_ENV":"production","RACK_ENV":"production","rvm_path":"./rvm"}


ruby_announcer = Process(
  name = 'ruby_announcer',
  cmdline = """/bin/bash ./run_ruby_announcer.sh announce sdzookeeper.local.twitter.com:2181/twitter/service/yhua/devel/uiTestLeaderboard {{mesos.instance}} HOST_NAME:{{thermos.ports[http]}} '{"aurora":"HOST_NAME:{{thermos.ports[http]}}","http":"HOST_NAME:{{thermos.ports[http]}}","health":"HOST_NAME:{{thermos.ports[http]}}"}' -u yhua:yhua""",
  daemon = True,
  max_failures = 100,
  ephemeral = True
)


run_uiTestLeaderboard = Process(
  name = 'run_uiTestLeaderboard',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"web\"')
)


run_uiTestLeaderboard_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


run_uiTestLeaderboard_scheduler = Process(
  name = 'run_uiTestLeaderboard_scheduler',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"scheduler\"')
)


run_uiTestLeaderboard_scheduler_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard_scheduler],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard_scheduler),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


update_config = UpdateConfig(
  batch_size = 1,
  restart_threshold = (60 + 10 * 6 + 2),
  watch_secs = (60 + 10 * 6 + 1)
)

health_config = HealthCheckConfig(
  initial_interval_secs=60,
  interval_secs = 10,
  timeout_secs = 10,
  max_consecutive_failures = 6
)

health_announcer = Announcer(
  portmap = {
    'health':'http',
    'aurora':'http'
  }
)

jobs = [
  Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uiTestLeaderboard_task,
    name='uiTestLeaderboard',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
  , Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uiTestLeaderboard_scheduler_task,
    name='uiTestLeaderboard_scheduler',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
]

I, [2014-08-25T13:11:19.779444 #81867]  INFO -- : Package added:
Version: 6
History:
  moved to state PRESENT by yhua on 08/25/2014 20:11:17 UTC

I, [2014-08-25T13:11:19.779639 #81867]  INFO -- : Writing log files to disk in /var/tmp

I, [2014-08-25T13:11:32.278440 #81867]  INFO -- : 
I, [2014-08-25T13:11:32.278754 #81867]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uiTestLeaderboard_scheduler
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-25T13:11:32.366196 #81867]  INFO -- : 
I, [2014-08-25T13:11:32.366400 #81867]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uiTestLeaderboard
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-25T13:14:15.283483 #81867]  INFO -- : 
I, [2014-08-25T13:14:15.283676 #81867]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uiTestLeaderboard
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package yhua/uiTestLeaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uiTestLeaderboard
 INFO] Active tasks found for job smf1/yhua/devel/uiTestLeaderboard. Updating existing job
 INFO] Updating job: uiTestLeaderboard
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uiTestLeaderboard

I, [2014-08-25T13:14:15.494390 #81867]  INFO -- : 
I, [2014-08-25T13:14:15.494588 #81867]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uiTestLeaderboard_scheduler
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package yhua/uiTestLeaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uiTestLeaderboard_scheduler
 INFO] Active tasks found for job smf1/yhua/devel/uiTestLeaderboard_scheduler. Updating existing job
 INFO] Updating job: uiTestLeaderboard_scheduler
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uiTestLeaderboard_scheduler

I, [2014-08-25T13:14:15.501617 #81867]  INFO -- : App: uiTestLeaderboard production branch: master succesfully deployed to http://uiTestLeaderboard.devel.yhua.service.smf1.twitter.com
I, [2014-08-25T13:20:38.038239 #82045]  INFO -- : Changeset: 503bcb8 - refer to stakeholder project and will modify later (31 seconds ago) <yingyanhua>
I, [2014-08-25T13:20:38.555753 #82045]  INFO -- : 
I, [2014-08-25T13:20:38.555920 #82045]  INFO -- : Cloning into '/var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140825-82045-1pi0cnt/git_root'...

I, [2014-08-25T13:20:38.568941 #82045]  INFO -- : 
I, [2014-08-25T13:20:38.569101 #82045]  INFO -- : 
I, [2014-08-25T13:20:38.569705 #82045]  INFO -- : Downloading your gems via Spitball server spitball.local.twitter.com...
I, [2014-08-25T13:29:57.622783 #82336]  INFO -- : Changeset: 503bcb8 - refer to stakeholder project and will modify later (10 minutes ago) <yingyanhua>
I, [2014-08-25T13:29:58.292986 #82336]  INFO -- : 
I, [2014-08-25T13:29:58.293148 #82336]  INFO -- : Cloning into '/var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140825-82336-1oucwac/git_root'...

I, [2014-08-25T13:29:58.307508 #82336]  INFO -- : 
I, [2014-08-25T13:29:58.307688 #82336]  INFO -- : 
I, [2014-08-25T13:29:58.308335 #82336]  INFO -- : Downloading your gems via Spitball server spitball.local.twitter.com...
I, [2014-08-25T13:33:33.724597 #82462]  INFO -- : Changeset: cf9128f - refer to stakeholder project and will modify later (79 seconds ago) <yingyanhua>
I, [2014-08-25T13:33:34.521383 #82462]  INFO -- : 
I, [2014-08-25T13:33:34.521574 #82462]  INFO -- : Cloning into '/var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140825-82462-h08f3b/git_root'...

I, [2014-08-25T13:33:34.534216 #82462]  INFO -- : 
I, [2014-08-25T13:33:34.534378 #82462]  INFO -- : 
I, [2014-08-25T13:33:34.534961 #82462]  INFO -- : Downloading your gems via Spitball server spitball.local.twitter.com...
I, [2014-08-25T13:33:35.387854 #82462]  INFO -- : 
I, [2014-08-25T13:33:35.388058 #82462]  INFO -- : 
I, [2014-08-25T13:33:35.393564 #82462]  INFO -- : /var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140825-82462-h08f3b/uiTestLeaderboard/config.mesos
I, [2014-08-25T13:33:35.395209 #82462]  INFO -- : # Generated by hayaku v3.13.4

import os

# Note: Packer.install inherits role from the job that runs it, and version's default is 'live'.

# Fetch dependencies
get_application = Packer.install('uiTestLeaderboard', version='latest')
get_ruby_1_9 = Packer.install('ruby-1_9_3-p484_shar', role = 'translate', version = 'live')
get_ruby_2_0 = Packer.install('ruby-2_0_0-p481_shar', role = 'translate', version = 'live')
get_ruby_2_1 = Packer.install('ruby-2_1_2_shar', role = 'translate', version = 'live')
get_nodejs = Packer.install('nodejs', role='mesos')
get_nginx = Packer.install('nginx_1_3_14', role = 'trix', version = 'latest')

mysql = Packer.install('mysql-5_5_23_t6_1', role = 'translate', version = 'live')

env = {"IS_MESOS":"1","GEM_HOME":"`pwd`/ruby_vendor/ruby/1.9.1/","LD_LIBRARY_PATH":"`pwd`/mysql/lib","PATH":"`pwd`/node_js/usr/local/bin:/opt/local/bin/:$PATH","RAILS_ENV":"production","RACK_ENV":"production","rvm_path":"./rvm"}


ruby_announcer = Process(
  name = 'ruby_announcer',
  cmdline = """/bin/bash ./run_ruby_announcer.sh announce sdzookeeper.local.twitter.com:2181/twitter/service/yhua/devel/uiTestLeaderboard {{mesos.instance}} HOST_NAME:{{thermos.ports[http]}} '{"aurora":"HOST_NAME:{{thermos.ports[http]}}","http":"HOST_NAME:{{thermos.ports[http]}}","health":"HOST_NAME:{{thermos.ports[http]}}"}' -u yhua:yhua""",
  daemon = True,
  max_failures = 100,
  ephemeral = True
)


run_uiTestLeaderboard = Process(
  name = 'run_uiTestLeaderboard',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"web\"')
)


run_uiTestLeaderboard_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


run_uiTestLeaderboard_scheduler = Process(
  name = 'run_uiTestLeaderboard_scheduler',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"scheduler\"')
)


run_uiTestLeaderboard_scheduler_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard_scheduler],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard_scheduler),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


update_config = UpdateConfig(
  batch_size = 1,
  restart_threshold = (60 + 10 * 6 + 2),
  watch_secs = (60 + 10 * 6 + 1)
)

health_config = HealthCheckConfig(
  initial_interval_secs=60,
  interval_secs = 10,
  timeout_secs = 10,
  max_consecutive_failures = 6
)

health_announcer = Announcer(
  portmap = {
    'health':'http',
    'aurora':'http'
  }
)

jobs = [
  Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uiTestLeaderboard_task,
    name='uiTestLeaderboard',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
  , Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uiTestLeaderboard_scheduler_task,
    name='uiTestLeaderboard_scheduler',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
]

I, [2014-08-25T13:33:49.998042 #82462]  INFO -- : Package added:
Version: 7
History:
  moved to state PRESENT by yhua on 08/25/2014 20:33:48 UTC

I, [2014-08-25T13:33:49.998218 #82462]  INFO -- : Writing log files to disk in /var/tmp

I, [2014-08-25T13:34:03.504778 #82462]  INFO -- : 
I, [2014-08-25T13:34:03.505025 #82462]  INFO -- : 
I, [2014-08-25T13:34:03.505074 #82462]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uiTestLeaderboard_scheduler
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-25T13:34:03.505128 #82462]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uiTestLeaderboard
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-25T13:36:46.652770 #82462]  INFO -- : 
I, [2014-08-25T13:36:46.652957 #82462]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uiTestLeaderboard_scheduler
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package yhua/uiTestLeaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uiTestLeaderboard_scheduler
 INFO] Active tasks found for job smf1/yhua/devel/uiTestLeaderboard_scheduler. Updating existing job
 INFO] Updating job: uiTestLeaderboard_scheduler
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uiTestLeaderboard_scheduler

I, [2014-08-25T13:36:54.840862 #82462]  INFO -- : 
I, [2014-08-25T13:36:54.841143 #82462]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uiTestLeaderboard
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package yhua/uiTestLeaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uiTestLeaderboard
 INFO] Active tasks found for job smf1/yhua/devel/uiTestLeaderboard. Updating existing job
 INFO] Updating job: uiTestLeaderboard
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uiTestLeaderboard

I, [2014-08-25T13:36:54.847514 #82462]  INFO -- : App: uiTestLeaderboard production branch: master succesfully deployed to http://uiTestLeaderboard.devel.yhua.service.smf1.twitter.com
I, [2014-08-25T13:59:21.143937 #82795]  INFO -- : Changeset: a0f9669 - cannot show page (13 minutes ago) <yingyanhua>
I, [2014-08-25T13:59:23.106845 #82795]  INFO -- : 
I, [2014-08-25T13:59:23.107053 #82795]  INFO -- : Cloning into '/var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140825-82795-ddd7yx/git_root'...

I, [2014-08-25T13:59:23.120896 #82795]  INFO -- : 
I, [2014-08-25T13:59:23.121099 #82795]  INFO -- : 
I, [2014-08-25T13:59:23.122204 #82795]  INFO -- : Downloading your gems via Spitball server spitball.local.twitter.com...
I, [2014-08-25T13:59:24.169025 #82795]  INFO -- : 
I, [2014-08-25T13:59:24.169375 #82795]  INFO -- : 
I, [2014-08-25T13:59:24.177617 #82795]  INFO -- : /var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140825-82795-ddd7yx/uiTestLeaderboard/config.mesos
I, [2014-08-25T13:59:24.179591 #82795]  INFO -- : # Generated by hayaku v3.13.4

import os

# Note: Packer.install inherits role from the job that runs it, and version's default is 'live'.

# Fetch dependencies
get_application = Packer.install('uiTestLeaderboard', version='latest')
get_ruby_1_9 = Packer.install('ruby-1_9_3-p484_shar', role = 'translate', version = 'live')
get_ruby_2_0 = Packer.install('ruby-2_0_0-p481_shar', role = 'translate', version = 'live')
get_ruby_2_1 = Packer.install('ruby-2_1_2_shar', role = 'translate', version = 'live')
get_nodejs = Packer.install('nodejs', role='mesos')
get_nginx = Packer.install('nginx_1_3_14', role = 'trix', version = 'latest')

mysql = Packer.install('mysql-5_5_23_t6_1', role = 'translate', version = 'live')

env = {"IS_MESOS":"1","GEM_HOME":"`pwd`/ruby_vendor/ruby/1.9.1/","LD_LIBRARY_PATH":"`pwd`/mysql/lib","PATH":"`pwd`/node_js/usr/local/bin:/opt/local/bin/:$PATH","RAILS_ENV":"production","RACK_ENV":"production","rvm_path":"./rvm"}


ruby_announcer = Process(
  name = 'ruby_announcer',
  cmdline = """/bin/bash ./run_ruby_announcer.sh announce sdzookeeper.local.twitter.com:2181/twitter/service/yhua/devel/uiTestLeaderboard {{mesos.instance}} HOST_NAME:{{thermos.ports[http]}} '{"aurora":"HOST_NAME:{{thermos.ports[http]}}","http":"HOST_NAME:{{thermos.ports[http]}}","health":"HOST_NAME:{{thermos.ports[http]}}"}' -u yhua:yhua""",
  daemon = True,
  max_failures = 100,
  ephemeral = True
)


run_uiTestLeaderboard = Process(
  name = 'run_uiTestLeaderboard',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"web\"')
)


run_uiTestLeaderboard_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


run_uiTestLeaderboard_scheduler = Process(
  name = 'run_uiTestLeaderboard_scheduler',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"scheduler\"')
)


run_uiTestLeaderboard_scheduler_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard_scheduler],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard_scheduler),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


update_config = UpdateConfig(
  batch_size = 1,
  restart_threshold = (60 + 10 * 6 + 2),
  watch_secs = (60 + 10 * 6 + 1)
)

health_config = HealthCheckConfig(
  initial_interval_secs=60,
  interval_secs = 10,
  timeout_secs = 10,
  max_consecutive_failures = 6
)

health_announcer = Announcer(
  portmap = {
    'health':'http',
    'aurora':'http'
  }
)

jobs = [
  Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uiTestLeaderboard_task,
    name='uiTestLeaderboard',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
  , Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uiTestLeaderboard_scheduler_task,
    name='uiTestLeaderboard_scheduler',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
]

I, [2014-08-25T13:59:38.908467 #82795]  INFO -- : Package added:
Version: 8
History:
  moved to state PRESENT by yhua on 08/25/2014 20:59:37 UTC

I, [2014-08-25T13:59:38.908646 #82795]  INFO -- : Writing log files to disk in /var/tmp

I, [2014-08-25T13:59:51.723292 #82795]  INFO -- : 
I, [2014-08-25T13:59:51.723488 #82795]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uiTestLeaderboard
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-25T13:59:51.747285 #82795]  INFO -- : 
I, [2014-08-25T13:59:51.747500 #82795]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uiTestLeaderboard_scheduler
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-25T14:02:44.811272 #82795]  INFO -- : 
I, [2014-08-25T14:02:44.811431 #82795]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uiTestLeaderboard_scheduler
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package yhua/uiTestLeaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uiTestLeaderboard_scheduler
 INFO] Active tasks found for job smf1/yhua/devel/uiTestLeaderboard_scheduler. Updating existing job
 INFO] Updating job: uiTestLeaderboard_scheduler
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uiTestLeaderboard_scheduler

I, [2014-08-25T14:02:49.496406 #82795]  INFO -- : 
I, [2014-08-25T14:02:49.496518 #82795]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uiTestLeaderboard
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package yhua/uiTestLeaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uiTestLeaderboard
 INFO] Active tasks found for job smf1/yhua/devel/uiTestLeaderboard. Updating existing job
 INFO] Updating job: uiTestLeaderboard
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uiTestLeaderboard

I, [2014-08-25T14:02:49.503451 #82795]  INFO -- : App: uiTestLeaderboard production branch: master succesfully deployed to http://uiTestLeaderboard.devel.yhua.service.smf1.twitter.com
I, [2014-08-25T15:40:25.891768 #83859]  INFO -- : Changeset: 
I, [2014-08-25T15:40:26.532175 #83859]  INFO -- : 
I, [2014-08-25T15:40:26.532385 #83859]  INFO -- : Cloning into '/var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140825-83859-iet2f4/git_root'...

I, [2014-08-25T15:40:26.545648 #83859]  INFO -- : 
I, [2014-08-25T15:40:26.545838 #83859]  INFO -- : 
I, [2014-08-25T15:40:26.546494 #83859]  INFO -- : Downloading your gems via Spitball server spitball.local.twitter.com...
I, [2014-08-25T16:04:09.372509 #84338]  INFO -- : Changeset: 80feddd - at least can fetch json file from *.twitter.biz (41 seconds ago) <yingyanhua>
I, [2014-08-25T16:04:10.781012 #84338]  INFO -- : 
I, [2014-08-25T16:04:10.781183 #84338]  INFO -- : Cloning into '/var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140825-84338-gvrvy3/git_root'...

I, [2014-08-25T16:04:10.794179 #84338]  INFO -- : 
I, [2014-08-25T16:04:10.794365 #84338]  INFO -- : 
I, [2014-08-25T16:04:10.795538 #84338]  INFO -- : Downloading your gems via Spitball server spitball.local.twitter.com...
I, [2014-08-25T16:04:13.942179 #84338]  INFO -- : 
I, [2014-08-25T16:04:13.942333 #84338]  INFO -- : 
I, [2014-08-25T16:04:13.960922 #84338]  INFO -- : /var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140825-84338-gvrvy3/uiTestLeaderboard/config.mesos
I, [2014-08-25T16:04:13.962627 #84338]  INFO -- : # Generated by hayaku v3.13.4

import os

# Note: Packer.install inherits role from the job that runs it, and version's default is 'live'.

# Fetch dependencies
get_application = Packer.install('uiTestLeaderboard', version='latest')
get_ruby_1_9 = Packer.install('ruby-1_9_3-p484_shar', role = 'translate', version = 'live')
get_ruby_2_0 = Packer.install('ruby-2_0_0-p481_shar', role = 'translate', version = 'live')
get_ruby_2_1 = Packer.install('ruby-2_1_2_shar', role = 'translate', version = 'live')
get_nodejs = Packer.install('nodejs', role='mesos')
get_nginx = Packer.install('nginx_1_3_14', role = 'trix', version = 'latest')

mysql = Packer.install('mysql-5_5_23_t6_1', role = 'translate', version = 'live')

env = {"IS_MESOS":"1","GEM_HOME":"`pwd`/ruby_vendor/ruby/1.9.1/","LD_LIBRARY_PATH":"`pwd`/mysql/lib","PATH":"`pwd`/node_js/usr/local/bin:/opt/local/bin/:$PATH","RAILS_ENV":"production","RACK_ENV":"production","rvm_path":"./rvm"}


ruby_announcer = Process(
  name = 'ruby_announcer',
  cmdline = """/bin/bash ./run_ruby_announcer.sh announce sdzookeeper.local.twitter.com:2181/twitter/service/yhua/devel/uiTestLeaderboard {{mesos.instance}} HOST_NAME:{{thermos.ports[http]}} '{"aurora":"HOST_NAME:{{thermos.ports[http]}}","http":"HOST_NAME:{{thermos.ports[http]}}","health":"HOST_NAME:{{thermos.ports[http]}}"}' -u yhua:yhua""",
  daemon = True,
  max_failures = 100,
  ephemeral = True
)


run_uiTestLeaderboard = Process(
  name = 'run_uiTestLeaderboard',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"web\"')
)


run_uiTestLeaderboard_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


run_uiTestLeaderboard_scheduler = Process(
  name = 'run_uiTestLeaderboard_scheduler',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"scheduler\"')
)


run_uiTestLeaderboard_scheduler_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard_scheduler],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard_scheduler),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


update_config = UpdateConfig(
  batch_size = 1,
  restart_threshold = (60 + 10 * 6 + 2),
  watch_secs = (60 + 10 * 6 + 1)
)

health_config = HealthCheckConfig(
  initial_interval_secs=60,
  interval_secs = 10,
  timeout_secs = 10,
  max_consecutive_failures = 6
)

health_announcer = Announcer(
  portmap = {
    'health':'http',
    'aurora':'http'
  }
)

jobs = [
  Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uiTestLeaderboard_task,
    name='uiTestLeaderboard',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
  , Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uiTestLeaderboard_scheduler_task,
    name='uiTestLeaderboard_scheduler',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
]

I, [2014-08-25T16:04:32.493198 #84338]  INFO -- : Package added:
Version: 9
History:
  moved to state PRESENT by yhua on 08/25/2014 23:04:30 UTC

I, [2014-08-25T16:04:32.493431 #84338]  INFO -- : Writing log files to disk in /var/tmp

I, [2014-08-25T16:04:45.019906 #84338]  INFO -- : 
I, [2014-08-25T16:04:45.020113 #84338]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uiTestLeaderboard
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-25T16:04:45.072606 #84338]  INFO -- : 
I, [2014-08-25T16:04:45.072794 #84338]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uiTestLeaderboard_scheduler
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-25T16:07:30.554870 #84338]  INFO -- : 
I, [2014-08-25T16:07:30.555092 #84338]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uiTestLeaderboard
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package yhua/uiTestLeaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uiTestLeaderboard
 INFO] Active tasks found for job smf1/yhua/devel/uiTestLeaderboard. Updating existing job
 INFO] Updating job: uiTestLeaderboard
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uiTestLeaderboard

I, [2014-08-25T16:07:30.622645 #84338]  INFO -- : 
I, [2014-08-25T16:07:30.622787 #84338]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uiTestLeaderboard_scheduler
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package yhua/uiTestLeaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uiTestLeaderboard_scheduler
 INFO] Active tasks found for job smf1/yhua/devel/uiTestLeaderboard_scheduler. Updating existing job
 INFO] Updating job: uiTestLeaderboard_scheduler
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uiTestLeaderboard_scheduler

I, [2014-08-25T16:07:30.630329 #84338]  INFO -- : App: uiTestLeaderboard production branch: master succesfully deployed to http://uiTestLeaderboard.devel.yhua.service.smf1.twitter.com
I, [2014-08-26T14:13:09.088159 #91134]  INFO -- : Changeset: 248dde7 - can indirect to different pages, and can choose which os team (12 minutes ago) <yingyanhua>
5f61aab - minor revision, can work (65 minutes ago) <yingyanhua>
5436829 - can run different pages, fetch latest json file in Ruby (2 hours ago) <yingyanhua>
914762c - add one more page (4 hours ago) <yingyanhua>
048cf27 - can fetch json file and don't need to create json locally (21 hours ago) <yingyanhua>
I, [2014-08-26T14:13:09.837760 #91134]  INFO -- : 
I, [2014-08-26T14:13:09.837904 #91134]  INFO -- : Cloning into '/var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140826-91134-1g1yrzz/git_root'...

I, [2014-08-26T14:13:09.851903 #91134]  INFO -- : 
I, [2014-08-26T14:13:09.852081 #91134]  INFO -- : 
I, [2014-08-26T14:13:09.853105 #91134]  INFO -- : Downloading your gems via Spitball server spitball.local.twitter.com...
I, [2014-08-26T14:13:10.920484 #91134]  INFO -- : 
I, [2014-08-26T14:13:10.920647 #91134]  INFO -- : 
I, [2014-08-26T14:13:10.941120 #91134]  INFO -- : /var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140826-91134-1g1yrzz/uiTestLeaderboard/config.mesos
I, [2014-08-26T14:13:10.942812 #91134]  INFO -- : # Generated by hayaku v3.13.4

import os

# Note: Packer.install inherits role from the job that runs it, and version's default is 'live'.

# Fetch dependencies
get_application = Packer.install('uiTestLeaderboard', version='latest')
get_ruby_1_9 = Packer.install('ruby-1_9_3-p484_shar', role = 'translate', version = 'live')
get_ruby_2_0 = Packer.install('ruby-2_0_0-p481_shar', role = 'translate', version = 'live')
get_ruby_2_1 = Packer.install('ruby-2_1_2_shar', role = 'translate', version = 'live')
get_nodejs = Packer.install('nodejs', role='mesos')
get_nginx = Packer.install('nginx_1_3_14', role = 'trix', version = 'latest')

mysql = Packer.install('mysql-5_5_23_t6_1', role = 'translate', version = 'live')

env = {"IS_MESOS":"1","GEM_HOME":"`pwd`/ruby_vendor/ruby/1.9.1/","LD_LIBRARY_PATH":"`pwd`/mysql/lib","PATH":"`pwd`/node_js/usr/local/bin:/opt/local/bin/:$PATH","RAILS_ENV":"production","RACK_ENV":"production","rvm_path":"./rvm"}


ruby_announcer = Process(
  name = 'ruby_announcer',
  cmdline = """/bin/bash ./run_ruby_announcer.sh announce sdzookeeper.local.twitter.com:2181/twitter/service/yhua/devel/uiTestLeaderboard {{mesos.instance}} HOST_NAME:{{thermos.ports[http]}} '{"aurora":"HOST_NAME:{{thermos.ports[http]}}","http":"HOST_NAME:{{thermos.ports[http]}}","health":"HOST_NAME:{{thermos.ports[http]}}"}' -u yhua:yhua""",
  daemon = True,
  max_failures = 100,
  ephemeral = True
)


run_uiTestLeaderboard = Process(
  name = 'run_uiTestLeaderboard',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"web\"')
)


run_uiTestLeaderboard_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


run_uiTestLeaderboard_scheduler = Process(
  name = 'run_uiTestLeaderboard_scheduler',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"scheduler\"')
)


run_uiTestLeaderboard_scheduler_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard_scheduler],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard_scheduler),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


update_config = UpdateConfig(
  batch_size = 1,
  restart_threshold = (60 + 10 * 6 + 2),
  watch_secs = (60 + 10 * 6 + 1)
)

health_config = HealthCheckConfig(
  initial_interval_secs=60,
  interval_secs = 10,
  timeout_secs = 10,
  max_consecutive_failures = 6
)

health_announcer = Announcer(
  portmap = {
    'health':'http',
    'aurora':'http'
  }
)

jobs = [
  Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uiTestLeaderboard_task,
    name='uiTestLeaderboard',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
  , Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uiTestLeaderboard_scheduler_task,
    name='uiTestLeaderboard_scheduler',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
]

I, [2014-08-26T14:13:27.737899 #91134]  INFO -- : Package added:
Version: 10
History:
  moved to state PRESENT by yhua on 08/26/2014 21:13:26 UTC

I, [2014-08-26T14:13:27.738117 #91134]  INFO -- : Writing log files to disk in /var/tmp

I, [2014-08-26T14:13:41.375107 #91134]  INFO -- : 
I, [2014-08-26T14:13:41.375504 #91134]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uiTestLeaderboard
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-26T14:13:41.418017 #91134]  INFO -- : 
I, [2014-08-26T14:13:41.418277 #91134]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uiTestLeaderboard_scheduler
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-26T14:16:37.121509 #91134]  INFO -- : 
I, [2014-08-26T14:16:37.121657 #91134]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uiTestLeaderboard_scheduler
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package yhua/uiTestLeaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uiTestLeaderboard_scheduler
 INFO] Active tasks found for job smf1/yhua/devel/uiTestLeaderboard_scheduler. Updating existing job
 INFO] Updating job: uiTestLeaderboard_scheduler
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uiTestLeaderboard_scheduler

I, [2014-08-26T14:16:37.325149 #91134]  INFO -- : 
I, [2014-08-26T14:16:37.325273 #91134]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uiTestLeaderboard
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package yhua/uiTestLeaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uiTestLeaderboard
 INFO] Active tasks found for job smf1/yhua/devel/uiTestLeaderboard. Updating existing job
 INFO] Updating job: uiTestLeaderboard
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uiTestLeaderboard

I, [2014-08-26T14:16:37.331709 #91134]  INFO -- : App: uiTestLeaderboard production branch: master succesfully deployed to http://uiTestLeaderboard.devel.yhua.service.smf1.twitter.com
E, [2014-08-26T14:25:36.745193 #91552] ERROR -- : Error running ssh deploy_info command:  INFO] Response from scheduler: OK (message: None)
Traceback (most recent call last):
  File "/Users/yhua/.tools-cache/home/aurora/tools/client/libexec/aurora-client/twitter/common/app/application.py", line 738, in _wrap_method
    return_code = method()
  File "/Users/yhua/.tools-cache/home/aurora/tools/client/libexec/aurora-client/twitter/common/app/application.py", line 760, in <lambda>
    main = lambda: main_method(*args, **kwargs)
  File "/Users/yhua/.tools-cache/home/aurora/tools/client/libexec/aurora-client/.deps/apache.aurora.clientv2-0.5.1_DEV1406838503-py2.6.egg/apache/aurora/client/commands/ssh.py", line 54, in ssh
    first_task = resp.result.scheduleStatusResult.tasks[0]
IndexError: list index out of range

I, [2014-08-26T14:25:36.745358 #91552]  INFO -- : Changeset is nil
I, [2014-08-26T14:25:36.751997 #91552]  INFO -- : Changeset: 
I, [2014-08-26T14:25:37.642218 #91552]  INFO -- : 
I, [2014-08-26T14:25:37.642404 #91552]  INFO -- : Cloning into '/var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140826-91552-hg2vu3/git_root'...

I, [2014-08-26T14:25:37.655078 #91552]  INFO -- : 
I, [2014-08-26T14:25:37.655272 #91552]  INFO -- : 
I, [2014-08-26T14:25:37.656059 #91552]  INFO -- : Downloading your gems via Spitball server spitball.local.twitter.com...
I, [2014-08-26T14:25:38.912565 #91552]  INFO -- : 
I, [2014-08-26T14:25:38.912780 #91552]  INFO -- : 
I, [2014-08-26T14:25:38.918547 #91552]  INFO -- : /var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140826-91552-hg2vu3/uiTestLeaderboard/config.mesos
I, [2014-08-26T14:25:38.920505 #91552]  INFO -- : # Generated by hayaku v3.13.4

import os

# Note: Packer.install inherits role from the job that runs it, and version's default is 'live'.

# Fetch dependencies
get_application = Packer.install('uiTestLeaderboard', version='latest')
get_ruby_1_9 = Packer.install('ruby-1_9_3-p484_shar', role = 'translate', version = 'live')
get_ruby_2_0 = Packer.install('ruby-2_0_0-p481_shar', role = 'translate', version = 'live')
get_ruby_2_1 = Packer.install('ruby-2_1_2_shar', role = 'translate', version = 'live')
get_nodejs = Packer.install('nodejs', role='mesos')
get_nginx = Packer.install('nginx_1_3_14', role = 'trix', version = 'latest')

mysql = Packer.install('mysql-5_5_23_t6_1', role = 'translate', version = 'live')

env = {"IS_MESOS":"1","GEM_HOME":"`pwd`/ruby_vendor/ruby/1.9.1/","LD_LIBRARY_PATH":"`pwd`/mysql/lib","PATH":"`pwd`/node_js/usr/local/bin:/opt/local/bin/:$PATH","RAILS_ENV":"production","RACK_ENV":"production","rvm_path":"./rvm"}


ruby_announcer = Process(
  name = 'ruby_announcer',
  cmdline = """/bin/bash ./run_ruby_announcer.sh announce sdzookeeper.local.twitter.com:2181/twitter/service/hayaku/devel/uiTestLeaderboard {{mesos.instance}} HOST_NAME:{{thermos.ports[http]}} '{"aurora":"HOST_NAME:{{thermos.ports[http]}}","http":"HOST_NAME:{{thermos.ports[http]}}","health":"HOST_NAME:{{thermos.ports[http]}}"}' -u hayaku:hayaku""",
  daemon = True,
  max_failures = 100,
  ephemeral = True
)


run_uiTestLeaderboard = Process(
  name = 'run_uiTestLeaderboard',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 604800 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"web\"')
)


run_uiTestLeaderboard_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


run_uiTestLeaderboard_scheduler = Process(
  name = 'run_uiTestLeaderboard_scheduler',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 604800 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"scheduler\"')
)


run_uiTestLeaderboard_scheduler_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard_scheduler],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard_scheduler),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


update_config = UpdateConfig(
  batch_size = 1,
  restart_threshold = (60 + 10 * 6 + 2),
  watch_secs = (60 + 10 * 6 + 1)
)

health_config = HealthCheckConfig(
  initial_interval_secs=60,
  interval_secs = 10,
  timeout_secs = 10,
  max_consecutive_failures = 6
)

health_announcer = Announcer(
  portmap = {
    'health':'http',
    'aurora':'http'
  }
)

jobs = [
  Job(
    cluster='smf1',
    role='hayaku',
    service=True,
    task=run_uiTestLeaderboard_task,
    name='uiTestLeaderboard',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
  , Job(
    cluster='smf1',
    role='hayaku',
    service=True,
    task=run_uiTestLeaderboard_scheduler_task,
    name='uiTestLeaderboard_scheduler',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
]

I, [2014-08-26T14:26:01.299336 #91552]  INFO -- : 
I, [2014-08-26T14:26:01.299484 #91552]  INFO -- : Writing log files to disk in /var/tmp
FATAL] Request failed: yhua is not authorized to act as role hayaku: com.twitter.common_internal.security.auth.OdsAuthenticator$OdsAuthFailedException: Authentication failed for yhua (status: 401 - Unauthorized)

I, [2014-08-26T14:27:34.488647 #91608]  INFO -- : Changeset: 
I, [2014-08-26T14:27:35.269968 #91608]  INFO -- : 
I, [2014-08-26T14:27:35.270138 #91608]  INFO -- : Cloning into '/var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140826-91608-1irlms9/git_root'...

I, [2014-08-26T14:27:35.287340 #91608]  INFO -- : 
I, [2014-08-26T14:27:35.287520 #91608]  INFO -- : 
I, [2014-08-26T14:27:35.288242 #91608]  INFO -- : Downloading your gems via Spitball server spitball.local.twitter.com...
I, [2014-08-26T14:27:36.327224 #91608]  INFO -- : 
I, [2014-08-26T14:27:36.327444 #91608]  INFO -- : 
I, [2014-08-26T14:27:36.334198 #91608]  INFO -- : /var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140826-91608-1irlms9/uiTestLeaderboard/config.mesos
I, [2014-08-26T14:27:36.336962 #91608]  INFO -- : # Generated by hayaku v3.13.4

import os

# Note: Packer.install inherits role from the job that runs it, and version's default is 'live'.

# Fetch dependencies
get_application = Packer.install('uiTestLeaderboard', version='latest')
get_ruby_1_9 = Packer.install('ruby-1_9_3-p484_shar', role = 'translate', version = 'live')
get_ruby_2_0 = Packer.install('ruby-2_0_0-p481_shar', role = 'translate', version = 'live')
get_ruby_2_1 = Packer.install('ruby-2_1_2_shar', role = 'translate', version = 'live')
get_nodejs = Packer.install('nodejs', role='mesos')
get_nginx = Packer.install('nginx_1_3_14', role = 'trix', version = 'latest')

mysql = Packer.install('mysql-5_5_23_t6_1', role = 'translate', version = 'live')

env = {"IS_MESOS":"1","GEM_HOME":"`pwd`/ruby_vendor/ruby/1.9.1/","LD_LIBRARY_PATH":"`pwd`/mysql/lib","PATH":"`pwd`/node_js/usr/local/bin:/opt/local/bin/:$PATH","RAILS_ENV":"production","RACK_ENV":"production","rvm_path":"./rvm"}


ruby_announcer = Process(
  name = 'ruby_announcer',
  cmdline = """/bin/bash ./run_ruby_announcer.sh announce sdzookeeper.local.twitter.com:2181/twitter/service/yhua/devel/uiTestLeaderboard {{mesos.instance}} HOST_NAME:{{thermos.ports[http]}} '{"aurora":"HOST_NAME:{{thermos.ports[http]}}","http":"HOST_NAME:{{thermos.ports[http]}}","health":"HOST_NAME:{{thermos.ports[http]}}"}' -u yhua:yhua""",
  daemon = True,
  max_failures = 100,
  ephemeral = True
)


run_uiTestLeaderboard = Process(
  name = 'run_uiTestLeaderboard',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"web\"')
)


run_uiTestLeaderboard_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


run_uiTestLeaderboard_scheduler = Process(
  name = 'run_uiTestLeaderboard_scheduler',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"scheduler\"')
)


run_uiTestLeaderboard_scheduler_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard_scheduler],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uiTestLeaderboard_scheduler),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


update_config = UpdateConfig(
  batch_size = 1,
  restart_threshold = (60 + 10 * 6 + 2),
  watch_secs = (60 + 10 * 6 + 1)
)

health_config = HealthCheckConfig(
  initial_interval_secs=60,
  interval_secs = 10,
  timeout_secs = 10,
  max_consecutive_failures = 6
)

health_announcer = Announcer(
  portmap = {
    'health':'http',
    'aurora':'http'
  }
)

jobs = [
  Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uiTestLeaderboard_task,
    name='uiTestLeaderboard',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
  , Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uiTestLeaderboard_scheduler_task,
    name='uiTestLeaderboard_scheduler',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
]

I, [2014-08-26T14:27:51.317435 #91608]  INFO -- : Package added:
Version: 11
History:
  moved to state PRESENT by yhua on 08/26/2014 21:27:50 UTC

I, [2014-08-26T14:27:51.317649 #91608]  INFO -- : Writing log files to disk in /var/tmp

I, [2014-08-26T14:28:03.899310 #91608]  INFO -- : 
I, [2014-08-26T14:28:03.899507 #91608]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uiTestLeaderboard_scheduler
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-26T14:28:03.910301 #91608]  INFO -- : 
I, [2014-08-26T14:28:03.910715 #91608]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uiTestLeaderboard
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-26T14:30:47.218679 #91608]  INFO -- : 
I, [2014-08-26T14:30:47.218861 #91608]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uiTestLeaderboard_scheduler
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package yhua/uiTestLeaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uiTestLeaderboard_scheduler
 INFO] Active tasks found for job smf1/yhua/devel/uiTestLeaderboard_scheduler. Updating existing job
 INFO] Updating job: uiTestLeaderboard_scheduler
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uiTestLeaderboard_scheduler

I, [2014-08-26T14:30:47.242591 #91608]  INFO -- : 
I, [2014-08-26T14:30:47.242798 #91608]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uiTestLeaderboard
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package yhua/uiTestLeaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uiTestLeaderboard
 INFO] Active tasks found for job smf1/yhua/devel/uiTestLeaderboard. Updating existing job
 INFO] Updating job: uiTestLeaderboard
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uiTestLeaderboard

I, [2014-08-26T14:30:47.249786 #91608]  INFO -- : App: uiTestLeaderboard production branch: master succesfully deployed to http://uiTestLeaderboard.devel.yhua.service.smf1.twitter.com
E, [2014-08-26T14:58:58.219035 #92201] ERROR -- : Error running ssh deploy_info command:  INFO] Response from scheduler: OK (message: None)
Traceback (most recent call last):
  File "/Users/yhua/.tools-cache/home/aurora/tools/client/libexec/aurora-client/twitter/common/app/application.py", line 738, in _wrap_method
    return_code = method()
  File "/Users/yhua/.tools-cache/home/aurora/tools/client/libexec/aurora-client/twitter/common/app/application.py", line 760, in <lambda>
    main = lambda: main_method(*args, **kwargs)
  File "/Users/yhua/.tools-cache/home/aurora/tools/client/libexec/aurora-client/.deps/apache.aurora.clientv2-0.5.1_DEV1406838503-py2.6.egg/apache/aurora/client/commands/ssh.py", line 54, in ssh
    first_task = resp.result.scheduleStatusResult.tasks[0]
IndexError: list index out of range

I, [2014-08-26T14:58:58.219207 #92201]  INFO -- : Changeset is nil
I, [2014-08-26T14:58:58.226166 #92201]  INFO -- : Changeset: 
I, [2014-08-26T14:59:00.432322 #92201]  INFO -- : 
I, [2014-08-26T14:59:00.432479 #92201]  INFO -- : Cloning into '/var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140826-92201-kr7pd6/git_root'...

I, [2014-08-26T14:59:00.446195 #92201]  INFO -- : 
I, [2014-08-26T14:59:00.446349 #92201]  INFO -- : 
I, [2014-08-26T14:59:00.447408 #92201]  INFO -- : Downloading your gems via Spitball server spitball.local.twitter.com...
I, [2014-08-26T14:59:01.471111 #92201]  INFO -- : 
I, [2014-08-26T14:59:01.471340 #92201]  INFO -- : 
I, [2014-08-26T14:59:01.486826 #92201]  INFO -- : /var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140826-92201-kr7pd6/uileaderboard/config.mesos
I, [2014-08-26T14:59:01.488883 #92201]  INFO -- : # Generated by hayaku v3.13.4

import os

# Note: Packer.install inherits role from the job that runs it, and version's default is 'live'.

# Fetch dependencies
get_application = Packer.install('uileaderboard', version='latest')
get_ruby_1_9 = Packer.install('ruby-1_9_3-p484_shar', role = 'translate', version = 'live')
get_ruby_2_0 = Packer.install('ruby-2_0_0-p481_shar', role = 'translate', version = 'live')
get_ruby_2_1 = Packer.install('ruby-2_1_2_shar', role = 'translate', version = 'live')
get_nodejs = Packer.install('nodejs', role='mesos')
get_nginx = Packer.install('nginx_1_3_14', role = 'trix', version = 'latest')

mysql = Packer.install('mysql-5_5_23_t6_1', role = 'translate', version = 'live')

env = {"IS_MESOS":"1","GEM_HOME":"`pwd`/ruby_vendor/ruby/1.9.1/","LD_LIBRARY_PATH":"`pwd`/mysql/lib","PATH":"`pwd`/node_js/usr/local/bin:/opt/local/bin/:$PATH","RAILS_ENV":"production","RACK_ENV":"production","rvm_path":"./rvm"}


ruby_announcer = Process(
  name = 'ruby_announcer',
  cmdline = """/bin/bash ./run_ruby_announcer.sh announce sdzookeeper.local.twitter.com:2181/twitter/service/yhua/devel/uileaderboard {{mesos.instance}} HOST_NAME:{{thermos.ports[http]}} '{"aurora":"HOST_NAME:{{thermos.ports[http]}}","http":"HOST_NAME:{{thermos.ports[http]}}","health":"HOST_NAME:{{thermos.ports[http]}}"}' -u yhua:yhua""",
  daemon = True,
  max_failures = 100,
  ephemeral = True
)


run_uileaderboard = Process(
  name = 'run_uileaderboard',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"web\"')
)


run_uileaderboard_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


run_uileaderboard_scheduler = Process(
  name = 'run_uileaderboard_scheduler',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"scheduler\"')
)


run_uileaderboard_scheduler_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


update_config = UpdateConfig(
  batch_size = 1,
  restart_threshold = (60 + 10 * 6 + 2),
  watch_secs = (60 + 10 * 6 + 1)
)

health_config = HealthCheckConfig(
  initial_interval_secs=60,
  interval_secs = 10,
  timeout_secs = 10,
  max_consecutive_failures = 6
)

health_announcer = Announcer(
  portmap = {
    'health':'http',
    'aurora':'http'
  }
)

jobs = [
  Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_task,
    name='uileaderboard',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
  , Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_scheduler_task,
    name='uileaderboard_scheduler',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
]

I, [2014-08-26T14:59:18.578788 #92201]  INFO -- : Package added:
Version: 1
History:
  moved to state PRESENT by yhua on 08/26/2014 21:59:17 UTC

I, [2014-08-26T14:59:18.579026 #92201]  INFO -- : Writing log files to disk in /var/tmp

I, [2014-08-26T14:59:31.197461 #92201]  INFO -- : 
I, [2014-08-26T14:59:31.197668 #92201]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-26T14:59:31.211803 #92201]  INFO -- : 
I, [2014-08-26T14:59:31.212113 #92201]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard_scheduler
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-26T14:59:52.371086 #92201]  INFO -- : 
I, [2014-08-26T14:59:52.371258 #92201]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard
 INFO] Retrieving jobs for role yhua
 INFO] No active tasks found for job smf1/yhua/devel/uileaderboard. Creating new job
 INFO] Creating job uileaderboard
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard

I, [2014-08-26T14:59:53.245627 #92201]  INFO -- : 
I, [2014-08-26T14:59:53.245758 #92201]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard_scheduler
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard_scheduler
 INFO] Retrieving jobs for role yhua
 INFO] No active tasks found for job smf1/yhua/devel/uileaderboard_scheduler. Creating new job
 INFO] Creating job uileaderboard_scheduler
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard_scheduler

I, [2014-08-26T14:59:53.252036 #92201]  INFO -- : App: uileaderboard production branch: master succesfully deployed to http://uileaderboard.devel.yhua.service.smf1.twitter.com
I, [2014-08-26T16:33:12.387184 #92780]  INFO -- : Changeset: 15fa2c9 - handle 404 error using Ruby (43 seconds ago) <yingyanhua>
I, [2014-08-26T16:33:13.566547 #92780]  INFO -- : 
I, [2014-08-26T16:33:13.566689 #92780]  INFO -- : Cloning into '/var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140826-92780-edw3fi/git_root'...

I, [2014-08-26T16:33:13.581483 #92780]  INFO -- : 
I, [2014-08-26T16:33:13.581700 #92780]  INFO -- : 
I, [2014-08-26T16:33:13.582389 #92780]  INFO -- : Downloading your gems via Spitball server spitball.local.twitter.com...
I, [2014-08-26T16:33:14.556302 #92780]  INFO -- : 
I, [2014-08-26T16:33:14.556496 #92780]  INFO -- : 
I, [2014-08-26T16:33:14.574118 #92780]  INFO -- : /var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140826-92780-edw3fi/uileaderboard/config.mesos
I, [2014-08-26T16:33:14.576653 #92780]  INFO -- : # Generated by hayaku v3.13.4

import os

# Note: Packer.install inherits role from the job that runs it, and version's default is 'live'.

# Fetch dependencies
get_application = Packer.install('uileaderboard', version='latest')
get_ruby_1_9 = Packer.install('ruby-1_9_3-p484_shar', role = 'translate', version = 'live')
get_ruby_2_0 = Packer.install('ruby-2_0_0-p481_shar', role = 'translate', version = 'live')
get_ruby_2_1 = Packer.install('ruby-2_1_2_shar', role = 'translate', version = 'live')
get_nodejs = Packer.install('nodejs', role='mesos')
get_nginx = Packer.install('nginx_1_3_14', role = 'trix', version = 'latest')

mysql = Packer.install('mysql-5_5_23_t6_1', role = 'translate', version = 'live')

env = {"IS_MESOS":"1","GEM_HOME":"`pwd`/ruby_vendor/ruby/1.9.1/","LD_LIBRARY_PATH":"`pwd`/mysql/lib","PATH":"`pwd`/node_js/usr/local/bin:/opt/local/bin/:$PATH","RAILS_ENV":"production","RACK_ENV":"production","rvm_path":"./rvm"}


ruby_announcer = Process(
  name = 'ruby_announcer',
  cmdline = """/bin/bash ./run_ruby_announcer.sh announce sdzookeeper.local.twitter.com:2181/twitter/service/yhua/devel/uileaderboard {{mesos.instance}} HOST_NAME:{{thermos.ports[http]}} '{"aurora":"HOST_NAME:{{thermos.ports[http]}}","http":"HOST_NAME:{{thermos.ports[http]}}","health":"HOST_NAME:{{thermos.ports[http]}}"}' -u yhua:yhua""",
  daemon = True,
  max_failures = 100,
  ephemeral = True
)


run_uileaderboard = Process(
  name = 'run_uileaderboard',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"web\"')
)


run_uileaderboard_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


run_uileaderboard_scheduler = Process(
  name = 'run_uileaderboard_scheduler',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"scheduler\"')
)


run_uileaderboard_scheduler_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


update_config = UpdateConfig(
  batch_size = 1,
  restart_threshold = (60 + 10 * 6 + 2),
  watch_secs = (60 + 10 * 6 + 1)
)

health_config = HealthCheckConfig(
  initial_interval_secs=60,
  interval_secs = 10,
  timeout_secs = 10,
  max_consecutive_failures = 6
)

health_announcer = Announcer(
  portmap = {
    'health':'http',
    'aurora':'http'
  }
)

jobs = [
  Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_task,
    name='uileaderboard',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
  , Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_scheduler_task,
    name='uileaderboard_scheduler',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
]

I, [2014-08-26T16:33:31.758035 #92780]  INFO -- : Package added:
Version: 2
History:
  moved to state PRESENT by yhua on 08/26/2014 23:33:30 UTC

I, [2014-08-26T16:33:31.758213 #92780]  INFO -- : Writing log files to disk in /var/tmp

I, [2014-08-26T16:33:44.436852 #92780]  INFO -- : 
I, [2014-08-26T16:33:44.437025 #92780]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-26T16:33:44.518362 #92780]  INFO -- : 
I, [2014-08-26T16:33:44.518563 #92780]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard_scheduler
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-26T16:36:28.221582 #92780]  INFO -- : 
I, [2014-08-26T16:36:28.221766 #92780]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard. Updating existing job
 INFO] Updating job: uileaderboard
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard

I, [2014-08-26T16:36:31.018831 #92780]  INFO -- : 
I, [2014-08-26T16:36:31.018981 #92780]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard_scheduler
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard_scheduler
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard_scheduler. Updating existing job
 INFO] Updating job: uileaderboard_scheduler
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard_scheduler

I, [2014-08-26T16:36:31.025972 #92780]  INFO -- : App: uileaderboard production branch: master succesfully deployed to http://uileaderboard.devel.yhua.service.smf1.twitter.com
<<<<<<< HEAD
I, [2014-08-27T09:30:56.960367 #94027]  INFO -- : Changeset: f171b11 - add link in front page (50 seconds ago) <yingyanhua>
I, [2014-08-27T09:30:58.088152 #94027]  INFO -- : 
I, [2014-08-27T09:30:58.088328 #94027]  INFO -- : Cloning into '/var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140827-94027-187ohh0/git_root'...

I, [2014-08-27T09:30:58.101516 #94027]  INFO -- : 
I, [2014-08-27T09:30:58.101722 #94027]  INFO -- : 
I, [2014-08-27T09:30:58.102381 #94027]  INFO -- : Downloading your gems via Spitball server spitball.local.twitter.com...
I, [2014-08-27T09:30:59.119482 #94027]  INFO -- : 
I, [2014-08-27T09:30:59.119665 #94027]  INFO -- : 
I, [2014-08-27T09:30:59.137162 #94027]  INFO -- : /var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140827-94027-187ohh0/uileaderboard/config.mesos
I, [2014-08-27T09:30:59.139337 #94027]  INFO -- : # Generated by hayaku v3.13.4

import os

# Note: Packer.install inherits role from the job that runs it, and version's default is 'live'.

# Fetch dependencies
get_application = Packer.install('uileaderboard', version='latest')
get_ruby_1_9 = Packer.install('ruby-1_9_3-p484_shar', role = 'translate', version = 'live')
get_ruby_2_0 = Packer.install('ruby-2_0_0-p481_shar', role = 'translate', version = 'live')
get_ruby_2_1 = Packer.install('ruby-2_1_2_shar', role = 'translate', version = 'live')
get_nodejs = Packer.install('nodejs', role='mesos')
get_nginx = Packer.install('nginx_1_3_14', role = 'trix', version = 'latest')

mysql = Packer.install('mysql-5_5_23_t6_1', role = 'translate', version = 'live')

env = {"IS_MESOS":"1","GEM_HOME":"`pwd`/ruby_vendor/ruby/1.9.1/","LD_LIBRARY_PATH":"`pwd`/mysql/lib","PATH":"`pwd`/node_js/usr/local/bin:/opt/local/bin/:$PATH","RAILS_ENV":"production","RACK_ENV":"production","rvm_path":"./rvm"}


ruby_announcer = Process(
  name = 'ruby_announcer',
  cmdline = """/bin/bash ./run_ruby_announcer.sh announce sdzookeeper.local.twitter.com:2181/twitter/service/yhua/devel/uileaderboard {{mesos.instance}} HOST_NAME:{{thermos.ports[http]}} '{"aurora":"HOST_NAME:{{thermos.ports[http]}}","http":"HOST_NAME:{{thermos.ports[http]}}","health":"HOST_NAME:{{thermos.ports[http]}}"}' -u yhua:yhua""",
  daemon = True,
  max_failures = 100,
  ephemeral = True
)


run_uileaderboard = Process(
  name = 'run_uileaderboard',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"web\"')
)


run_uileaderboard_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


run_uileaderboard_scheduler = Process(
  name = 'run_uileaderboard_scheduler',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"scheduler\"')
)


run_uileaderboard_scheduler_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


update_config = UpdateConfig(
  batch_size = 1,
  restart_threshold = (60 + 10 * 6 + 2),
  watch_secs = (60 + 10 * 6 + 1)
)

health_config = HealthCheckConfig(
  initial_interval_secs=60,
  interval_secs = 10,
  timeout_secs = 10,
  max_consecutive_failures = 6
)

health_announcer = Announcer(
  portmap = {
    'health':'http',
    'aurora':'http'
  }
)

jobs = [
  Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_task,
    name='uileaderboard',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
  , Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_scheduler_task,
    name='uileaderboard_scheduler',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
]

I, [2014-08-27T09:31:16.925220 #94027]  INFO -- : Package added:
Version: 3
History:
  moved to state PRESENT by yhua on 08/27/2014 16:31:15 UTC

I, [2014-08-27T09:31:16.925622 #94027]  INFO -- : Writing log files to disk in /var/tmp

I, [2014-08-27T09:31:29.440730 #94027]  INFO -- : 
I, [2014-08-27T09:31:29.440912 #94027]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard_scheduler
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-27T09:31:29.533735 #94027]  INFO -- : 
I, [2014-08-27T09:31:29.533946 #94027]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-27T09:34:11.902136 #94027]  INFO -- : 
I, [2014-08-27T09:34:11.902312 #94027]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard. Updating existing job
 INFO] Updating job: uileaderboard
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard

I, [2014-08-27T09:34:12.007046 #94027]  INFO -- : 
I, [2014-08-27T09:34:12.007231 #94027]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard_scheduler
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard_scheduler
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard_scheduler. Updating existing job
 INFO] Updating job: uileaderboard_scheduler
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard_scheduler

I, [2014-08-27T09:34:12.013524 #94027]  INFO -- : App: uileaderboard production branch: master succesfully deployed to http://uileaderboard.devel.yhua.service.smf1.twitter.com
=======
>>>>>>> f171b11fb240a11074663889c9fc2b1022f81748
I, [2014-08-27T09:47:11.076725 #94495]  INFO -- : Changeset: 2eb0d6e - conflict (56 seconds ago) <yingyanhua>
552b77b - add link in front page (2 minutes ago) <yingyanhua>
I, [2014-08-27T09:47:12.373140 #94495]  INFO -- : 
I, [2014-08-27T09:47:12.373324 #94495]  INFO -- : Cloning into '/var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140827-94495-171k5w5/git_root'...

I, [2014-08-27T09:47:12.388531 #94495]  INFO -- : 
I, [2014-08-27T09:47:12.388733 #94495]  INFO -- : 
I, [2014-08-27T09:47:12.389523 #94495]  INFO -- : Downloading your gems via Spitball server spitball.local.twitter.com...
I, [2014-08-27T09:47:13.654994 #94495]  INFO -- : 
I, [2014-08-27T09:47:13.655157 #94495]  INFO -- : 
I, [2014-08-27T09:47:13.661365 #94495]  INFO -- : /var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140827-94495-171k5w5/uileaderboard/config.mesos
I, [2014-08-27T09:47:13.663534 #94495]  INFO -- : # Generated by hayaku v3.13.4

import os

# Note: Packer.install inherits role from the job that runs it, and version's default is 'live'.

# Fetch dependencies
get_application = Packer.install('uileaderboard', version='latest')
get_ruby_1_9 = Packer.install('ruby-1_9_3-p484_shar', role = 'translate', version = 'live')
get_ruby_2_0 = Packer.install('ruby-2_0_0-p481_shar', role = 'translate', version = 'live')
get_ruby_2_1 = Packer.install('ruby-2_1_2_shar', role = 'translate', version = 'live')
get_nodejs = Packer.install('nodejs', role='mesos')
get_nginx = Packer.install('nginx_1_3_14', role = 'trix', version = 'latest')

mysql = Packer.install('mysql-5_5_23_t6_1', role = 'translate', version = 'live')

env = {"IS_MESOS":"1","GEM_HOME":"`pwd`/ruby_vendor/ruby/1.9.1/","LD_LIBRARY_PATH":"`pwd`/mysql/lib","PATH":"`pwd`/node_js/usr/local/bin:/opt/local/bin/:$PATH","RAILS_ENV":"production","RACK_ENV":"production","rvm_path":"./rvm"}


ruby_announcer = Process(
  name = 'ruby_announcer',
  cmdline = """/bin/bash ./run_ruby_announcer.sh announce sdzookeeper.local.twitter.com:2181/twitter/service/yhua/devel/uileaderboard {{mesos.instance}} HOST_NAME:{{thermos.ports[http]}} '{"aurora":"HOST_NAME:{{thermos.ports[http]}}","http":"HOST_NAME:{{thermos.ports[http]}}","health":"HOST_NAME:{{thermos.ports[http]}}"}' -u yhua:yhua""",
  daemon = True,
  max_failures = 100,
  ephemeral = True
)


run_uileaderboard = Process(
  name = 'run_uileaderboard',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"web\"')
)


run_uileaderboard_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


run_uileaderboard_scheduler = Process(
  name = 'run_uileaderboard_scheduler',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"scheduler\"')
)


run_uileaderboard_scheduler_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


update_config = UpdateConfig(
  batch_size = 1,
  restart_threshold = (60 + 10 * 6 + 2),
  watch_secs = (60 + 10 * 6 + 1)
)

health_config = HealthCheckConfig(
  initial_interval_secs=60,
  interval_secs = 10,
  timeout_secs = 10,
  max_consecutive_failures = 6
)

health_announcer = Announcer(
  portmap = {
    'health':'http',
    'aurora':'http'
  }
)

jobs = [
  Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_task,
    name='uileaderboard',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
  , Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_scheduler_task,
    name='uileaderboard_scheduler',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
]

I, [2014-08-27T09:47:32.989542 #94495]  INFO -- : Package added:
Version: 4
History:
  moved to state PRESENT by yhua on 08/27/2014 16:47:31 UTC

I, [2014-08-27T09:47:32.989857 #94495]  INFO -- : Writing log files to disk in /var/tmp

I, [2014-08-27T09:47:45.520847 #94495]  INFO -- : 
I, [2014-08-27T09:47:45.521117 #94495]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard_scheduler
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-27T09:47:45.698719 #94495]  INFO -- : 
I, [2014-08-27T09:47:45.698929 #94495]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-27T09:50:33.584687 #94495]  INFO -- : 
I, [2014-08-27T09:50:33.584842 #94495]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard_scheduler
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard_scheduler
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard_scheduler. Updating existing job
 INFO] Updating job: uileaderboard_scheduler
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard_scheduler

I, [2014-08-27T09:50:34.322295 #94495]  INFO -- : 
I, [2014-08-27T09:50:34.322426 #94495]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard. Updating existing job
 INFO] Updating job: uileaderboard
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard

I, [2014-08-27T09:50:34.328993 #94495]  INFO -- : App: uileaderboard production branch: master succesfully deployed to http://uileaderboard.devel.yhua.service.smf1.twitter.com
I, [2014-08-27T11:49:14.271858 #98522]  INFO -- : Changeset: f22327a - change some url (37 seconds ago) <yingyanhua>
I, [2014-08-27T11:49:15.397311 #98522]  INFO -- : 
I, [2014-08-27T11:49:15.397527 #98522]  INFO -- : Cloning into '/var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140827-98522-1es2ghe/git_root'...

I, [2014-08-27T11:49:15.411198 #98522]  INFO -- : 
I, [2014-08-27T11:49:15.411414 #98522]  INFO -- : 
I, [2014-08-27T11:49:15.412496 #98522]  INFO -- : Downloading your gems via Spitball server spitball.local.twitter.com...
I, [2014-08-27T11:49:16.393669 #98522]  INFO -- : 
I, [2014-08-27T11:49:16.394160 #98522]  INFO -- : 
I, [2014-08-27T11:49:16.413653 #98522]  INFO -- : /var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140827-98522-1es2ghe/uileaderboard/config.mesos
I, [2014-08-27T11:49:16.415382 #98522]  INFO -- : # Generated by hayaku v3.13.4

import os

# Note: Packer.install inherits role from the job that runs it, and version's default is 'live'.

# Fetch dependencies
get_application = Packer.install('uileaderboard', version='latest')
get_ruby_1_9 = Packer.install('ruby-1_9_3-p484_shar', role = 'translate', version = 'live')
get_ruby_2_0 = Packer.install('ruby-2_0_0-p481_shar', role = 'translate', version = 'live')
get_ruby_2_1 = Packer.install('ruby-2_1_2_shar', role = 'translate', version = 'live')
get_nodejs = Packer.install('nodejs', role='mesos')
get_nginx = Packer.install('nginx_1_3_14', role = 'trix', version = 'latest')

mysql = Packer.install('mysql-5_5_23_t6_1', role = 'translate', version = 'live')

env = {"IS_MESOS":"1","GEM_HOME":"`pwd`/ruby_vendor/ruby/1.9.1/","LD_LIBRARY_PATH":"`pwd`/mysql/lib","PATH":"`pwd`/node_js/usr/local/bin:/opt/local/bin/:$PATH","RAILS_ENV":"production","RACK_ENV":"production","rvm_path":"./rvm"}


ruby_announcer = Process(
  name = 'ruby_announcer',
  cmdline = """/bin/bash ./run_ruby_announcer.sh announce sdzookeeper.local.twitter.com:2181/twitter/service/yhua/devel/uileaderboard {{mesos.instance}} HOST_NAME:{{thermos.ports[http]}} '{"aurora":"HOST_NAME:{{thermos.ports[http]}}","http":"HOST_NAME:{{thermos.ports[http]}}","health":"HOST_NAME:{{thermos.ports[http]}}"}' -u yhua:yhua""",
  daemon = True,
  max_failures = 100,
  ephemeral = True
)


run_uileaderboard = Process(
  name = 'run_uileaderboard',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"web\"')
)


run_uileaderboard_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


run_uileaderboard_scheduler = Process(
  name = 'run_uileaderboard_scheduler',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"scheduler\"')
)


run_uileaderboard_scheduler_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


update_config = UpdateConfig(
  batch_size = 1,
  restart_threshold = (60 + 10 * 6 + 2),
  watch_secs = (60 + 10 * 6 + 1)
)

health_config = HealthCheckConfig(
  initial_interval_secs=60,
  interval_secs = 10,
  timeout_secs = 10,
  max_consecutive_failures = 6
)

health_announcer = Announcer(
  portmap = {
    'health':'http',
    'aurora':'http'
  }
)

jobs = [
  Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_task,
    name='uileaderboard',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
  , Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_scheduler_task,
    name='uileaderboard_scheduler',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
]

I, [2014-08-27T11:49:33.927792 #98522]  INFO -- : Package added:
Version: 5
History:
  moved to state PRESENT by yhua on 08/27/2014 18:49:32 UTC

I, [2014-08-27T11:49:33.927997 #98522]  INFO -- : Writing log files to disk in /var/tmp

I, [2014-08-27T11:49:52.662794 #98522]  INFO -- : 
I, [2014-08-27T11:49:52.662954 #98522]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard_scheduler
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-27T11:49:52.741056 #98522]  INFO -- : 
I, [2014-08-27T11:49:52.741285 #98522]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-27T11:52:43.439018 #98522]  INFO -- : 
I, [2014-08-27T11:52:43.439200 #98522]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard. Updating existing job
 INFO] Updating job: uileaderboard
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard

I, [2014-08-27T11:52:43.659471 #98522]  INFO -- : 
I, [2014-08-27T11:52:43.659614 #98522]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard_scheduler
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard_scheduler
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard_scheduler. Updating existing job
 INFO] Updating job: uileaderboard_scheduler
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard_scheduler

I, [2014-08-27T11:52:43.666899 #98522]  INFO -- : App: uileaderboard production branch: master succesfully deployed to http://uileaderboard.devel.yhua.service.smf1.twitter.com
I, [2014-08-27T13:50:28.674776 #99660]  INFO -- : Changeset: 6ca4b82 - minor revision (36 seconds ago) <yingyanhua>
I, [2014-08-27T13:50:29.830208 #99660]  INFO -- : 
I, [2014-08-27T13:50:29.830367 #99660]  INFO -- : Cloning into '/var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140827-99660-8vm01t/git_root'...

I, [2014-08-27T13:50:29.842975 #99660]  INFO -- : 
I, [2014-08-27T13:50:29.843143 #99660]  INFO -- : 
I, [2014-08-27T13:50:29.843732 #99660]  INFO -- : Downloading your gems via Spitball server spitball.local.twitter.com...
I, [2014-08-27T13:50:30.856987 #99660]  INFO -- : 
I, [2014-08-27T13:50:30.857199 #99660]  INFO -- : 
I, [2014-08-27T13:50:30.874576 #99660]  INFO -- : /var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140827-99660-8vm01t/uileaderboard/config.mesos
I, [2014-08-27T13:50:30.876205 #99660]  INFO -- : # Generated by hayaku v3.13.4

import os

# Note: Packer.install inherits role from the job that runs it, and version's default is 'live'.

# Fetch dependencies
get_application = Packer.install('uileaderboard', version='latest')
get_ruby_1_9 = Packer.install('ruby-1_9_3-p484_shar', role = 'translate', version = 'live')
get_ruby_2_0 = Packer.install('ruby-2_0_0-p481_shar', role = 'translate', version = 'live')
get_ruby_2_1 = Packer.install('ruby-2_1_2_shar', role = 'translate', version = 'live')
get_nodejs = Packer.install('nodejs', role='mesos')
get_nginx = Packer.install('nginx_1_3_14', role = 'trix', version = 'latest')

mysql = Packer.install('mysql-5_5_23_t6_1', role = 'translate', version = 'live')

env = {"IS_MESOS":"1","GEM_HOME":"`pwd`/ruby_vendor/ruby/1.9.1/","LD_LIBRARY_PATH":"`pwd`/mysql/lib","PATH":"`pwd`/node_js/usr/local/bin:/opt/local/bin/:$PATH","RAILS_ENV":"production","RACK_ENV":"production","rvm_path":"./rvm"}


ruby_announcer = Process(
  name = 'ruby_announcer',
  cmdline = """/bin/bash ./run_ruby_announcer.sh announce sdzookeeper.local.twitter.com:2181/twitter/service/yhua/devel/uileaderboard {{mesos.instance}} HOST_NAME:{{thermos.ports[http]}} '{"aurora":"HOST_NAME:{{thermos.ports[http]}}","http":"HOST_NAME:{{thermos.ports[http]}}","health":"HOST_NAME:{{thermos.ports[http]}}"}' -u yhua:yhua""",
  daemon = True,
  max_failures = 100,
  ephemeral = True
)


run_uileaderboard = Process(
  name = 'run_uileaderboard',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"web\"')
)


run_uileaderboard_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


run_uileaderboard_scheduler = Process(
  name = 'run_uileaderboard_scheduler',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"scheduler\"')
)


run_uileaderboard_scheduler_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


update_config = UpdateConfig(
  batch_size = 1,
  restart_threshold = (60 + 10 * 6 + 2),
  watch_secs = (60 + 10 * 6 + 1)
)

health_config = HealthCheckConfig(
  initial_interval_secs=60,
  interval_secs = 10,
  timeout_secs = 10,
  max_consecutive_failures = 6
)

health_announcer = Announcer(
  portmap = {
    'health':'http',
    'aurora':'http'
  }
)

jobs = [
  Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_task,
    name='uileaderboard',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
  , Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_scheduler_task,
    name='uileaderboard_scheduler',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
]

I, [2014-08-27T13:50:47.967660 #99660]  INFO -- : Package added:
Version: 6
History:
  moved to state PRESENT by yhua on 08/27/2014 20:50:46 UTC

I, [2014-08-27T13:50:47.967868 #99660]  INFO -- : Writing log files to disk in /var/tmp

I, [2014-08-27T13:51:00.619561 #99660]  INFO -- : 
I, [2014-08-27T13:51:00.619732 #99660]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-27T13:51:00.774789 #99660]  INFO -- : 
I, [2014-08-27T13:51:00.774964 #99660]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard_scheduler
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-27T13:53:45.841348 #99660]  INFO -- : 
I, [2014-08-27T13:53:45.841502 #99660]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard. Updating existing job
 INFO] Updating job: uileaderboard
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard

I, [2014-08-27T13:53:45.886058 #99660]  INFO -- : 
I, [2014-08-27T13:53:45.886191 #99660]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard_scheduler
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard_scheduler
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard_scheduler. Updating existing job
 INFO] Updating job: uileaderboard_scheduler
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard_scheduler

I, [2014-08-27T13:53:45.892692 #99660]  INFO -- : App: uileaderboard production branch: master succesfully deployed to http://uileaderboard.devel.yhua.service.smf1.twitter.com
I, [2014-08-27T14:49:07.949475 #182]  INFO -- : Changeset: 01ffe1f - can get every time js calls (51 seconds ago) <yingyanhua>
I, [2014-08-27T14:49:09.191970 #182]  INFO -- : 
I, [2014-08-27T14:49:09.192149 #182]  INFO -- : Cloning into '/var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140827-182-ytv2w6/git_root'...

I, [2014-08-27T14:49:09.204250 #182]  INFO -- : 
I, [2014-08-27T14:49:09.204412 #182]  INFO -- : 
I, [2014-08-27T14:49:09.205017 #182]  INFO -- : Downloading your gems via Spitball server spitball.local.twitter.com...
I, [2014-08-27T14:49:09.904684 #182]  INFO -- : 
I, [2014-08-27T14:49:09.905069 #182]  INFO -- : 
I, [2014-08-27T14:49:09.926009 #182]  INFO -- : /var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140827-182-ytv2w6/uileaderboard/config.mesos
I, [2014-08-27T14:49:09.927866 #182]  INFO -- : # Generated by hayaku v3.13.4

import os

# Note: Packer.install inherits role from the job that runs it, and version's default is 'live'.

# Fetch dependencies
get_application = Packer.install('uileaderboard', version='latest')
get_ruby_1_9 = Packer.install('ruby-1_9_3-p484_shar', role = 'translate', version = 'live')
get_ruby_2_0 = Packer.install('ruby-2_0_0-p481_shar', role = 'translate', version = 'live')
get_ruby_2_1 = Packer.install('ruby-2_1_2_shar', role = 'translate', version = 'live')
get_nodejs = Packer.install('nodejs', role='mesos')
get_nginx = Packer.install('nginx_1_3_14', role = 'trix', version = 'latest')

mysql = Packer.install('mysql-5_5_23_t6_1', role = 'translate', version = 'live')

env = {"IS_MESOS":"1","GEM_HOME":"`pwd`/ruby_vendor/ruby/1.9.1/","LD_LIBRARY_PATH":"`pwd`/mysql/lib","PATH":"`pwd`/node_js/usr/local/bin:/opt/local/bin/:$PATH","RAILS_ENV":"production","RACK_ENV":"production","rvm_path":"./rvm"}


ruby_announcer = Process(
  name = 'ruby_announcer',
  cmdline = """/bin/bash ./run_ruby_announcer.sh announce sdzookeeper.local.twitter.com:2181/twitter/service/yhua/devel/uileaderboard {{mesos.instance}} HOST_NAME:{{thermos.ports[http]}} '{"aurora":"HOST_NAME:{{thermos.ports[http]}}","http":"HOST_NAME:{{thermos.ports[http]}}","health":"HOST_NAME:{{thermos.ports[http]}}"}' -u yhua:yhua""",
  daemon = True,
  max_failures = 100,
  ephemeral = True
)


run_uileaderboard = Process(
  name = 'run_uileaderboard',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"web\"')
)


run_uileaderboard_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


run_uileaderboard_scheduler = Process(
  name = 'run_uileaderboard_scheduler',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"scheduler\"')
)


run_uileaderboard_scheduler_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


update_config = UpdateConfig(
  batch_size = 1,
  restart_threshold = (60 + 10 * 6 + 2),
  watch_secs = (60 + 10 * 6 + 1)
)

health_config = HealthCheckConfig(
  initial_interval_secs=60,
  interval_secs = 10,
  timeout_secs = 10,
  max_consecutive_failures = 6
)

health_announcer = Announcer(
  portmap = {
    'health':'http',
    'aurora':'http'
  }
)

jobs = [
  Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_task,
    name='uileaderboard',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
  , Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_scheduler_task,
    name='uileaderboard_scheduler',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
]

I, [2014-08-27T14:49:27.121972 #182]  INFO -- : Package added:
Version: 7
History:
  moved to state PRESENT by yhua on 08/27/2014 21:49:25 UTC

I, [2014-08-27T14:49:27.122164 #182]  INFO -- : Writing log files to disk in /var/tmp

I, [2014-08-27T14:49:39.786240 #182]  INFO -- : 
I, [2014-08-27T14:49:39.786385 #182]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-27T14:49:39.849986 #182]  INFO -- : 
I, [2014-08-27T14:49:39.850206 #182]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard_scheduler
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-27T14:52:22.784684 #182]  INFO -- : 
I, [2014-08-27T14:52:22.784985 #182]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard. Updating existing job
 INFO] Updating job: uileaderboard
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard

I, [2014-08-27T14:52:22.901907 #182]  INFO -- : 
I, [2014-08-27T14:52:22.902018 #182]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard_scheduler
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard_scheduler
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard_scheduler. Updating existing job
 INFO] Updating job: uileaderboard_scheduler
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard_scheduler

I, [2014-08-27T14:52:22.908354 #182]  INFO -- : App: uileaderboard production branch: master succesfully deployed to http://uileaderboard.devel.yhua.service.smf1.twitter.com
I, [2014-08-27T17:00:15.188448 #1313]  INFO -- : Changeset: bb52a2d - make some changes related to js file and rb file (3 minutes ago) <yingyanhua>
I, [2014-08-27T17:00:16.424557 #1313]  INFO -- : 
I, [2014-08-27T17:00:16.424737 #1313]  INFO -- : Cloning into '/var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140827-1313-j4f5hi/git_root'...

I, [2014-08-27T17:00:16.437303 #1313]  INFO -- : 
I, [2014-08-27T17:00:16.437530 #1313]  INFO -- : 
I, [2014-08-27T17:00:16.438622 #1313]  INFO -- : Downloading your gems via Spitball server spitball.local.twitter.com...
I, [2014-08-27T17:00:17.483752 #1313]  INFO -- : 
I, [2014-08-27T17:00:17.483936 #1313]  INFO -- : 
I, [2014-08-27T17:00:17.502959 #1313]  INFO -- : /var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140827-1313-j4f5hi/uileaderboard/config.mesos
I, [2014-08-27T17:00:17.504779 #1313]  INFO -- : # Generated by hayaku v3.13.4

import os

# Note: Packer.install inherits role from the job that runs it, and version's default is 'live'.

# Fetch dependencies
get_application = Packer.install('uileaderboard', version='latest')
get_ruby_1_9 = Packer.install('ruby-1_9_3-p484_shar', role = 'translate', version = 'live')
get_ruby_2_0 = Packer.install('ruby-2_0_0-p481_shar', role = 'translate', version = 'live')
get_ruby_2_1 = Packer.install('ruby-2_1_2_shar', role = 'translate', version = 'live')
get_nodejs = Packer.install('nodejs', role='mesos')
get_nginx = Packer.install('nginx_1_3_14', role = 'trix', version = 'latest')

mysql = Packer.install('mysql-5_5_23_t6_1', role = 'translate', version = 'live')

env = {"IS_MESOS":"1","GEM_HOME":"`pwd`/ruby_vendor/ruby/1.9.1/","LD_LIBRARY_PATH":"`pwd`/mysql/lib","PATH":"`pwd`/node_js/usr/local/bin:/opt/local/bin/:$PATH","RAILS_ENV":"production","RACK_ENV":"production","rvm_path":"./rvm"}


ruby_announcer = Process(
  name = 'ruby_announcer',
  cmdline = """/bin/bash ./run_ruby_announcer.sh announce sdzookeeper.local.twitter.com:2181/twitter/service/yhua/devel/uileaderboard {{mesos.instance}} HOST_NAME:{{thermos.ports[http]}} '{"aurora":"HOST_NAME:{{thermos.ports[http]}}","http":"HOST_NAME:{{thermos.ports[http]}}","health":"HOST_NAME:{{thermos.ports[http]}}"}' -u yhua:yhua""",
  daemon = True,
  max_failures = 100,
  ephemeral = True
)


run_uileaderboard = Process(
  name = 'run_uileaderboard',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"web\"')
)


run_uileaderboard_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


run_uileaderboard_scheduler = Process(
  name = 'run_uileaderboard_scheduler',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"scheduler\"')
)


run_uileaderboard_scheduler_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


update_config = UpdateConfig(
  batch_size = 1,
  restart_threshold = (60 + 10 * 6 + 2),
  watch_secs = (60 + 10 * 6 + 1)
)

health_config = HealthCheckConfig(
  initial_interval_secs=60,
  interval_secs = 10,
  timeout_secs = 10,
  max_consecutive_failures = 6
)

health_announcer = Announcer(
  portmap = {
    'health':'http',
    'aurora':'http'
  }
)

jobs = [
  Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_task,
    name='uileaderboard',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
  , Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_scheduler_task,
    name='uileaderboard_scheduler',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
]

I, [2014-08-27T17:00:34.176831 #1313]  INFO -- : Package added:
Version: 8
History:
  moved to state PRESENT by yhua on 08/28/2014 00:00:32 UTC

I, [2014-08-27T17:00:34.177033 #1313]  INFO -- : Writing log files to disk in /var/tmp

I, [2014-08-27T17:00:46.750442 #1313]  INFO -- : 
I, [2014-08-27T17:00:46.750628 #1313]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard_scheduler
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-27T17:00:46.819853 #1313]  INFO -- : 
I, [2014-08-27T17:00:46.820137 #1313]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-27T17:03:36.053381 #1313]  INFO -- : 
I, [2014-08-27T17:03:36.053571 #1313]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard. Updating existing job
 INFO] Updating job: uileaderboard
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard

I, [2014-08-27T17:03:36.475089 #1313]  INFO -- : 
I, [2014-08-27T17:03:36.475276 #1313]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard_scheduler
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard_scheduler
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard_scheduler. Updating existing job
 INFO] Updating job: uileaderboard_scheduler
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard_scheduler

I, [2014-08-27T17:03:36.482839 #1313]  INFO -- : App: uileaderboard production branch: master succesfully deployed to http://uileaderboard.devel.yhua.service.smf1.twitter.com
I, [2014-08-28T09:46:55.436393 #2474]  INFO -- : Changeset: 8b528ec - add loading gif and check js style (39 seconds ago) <yingyanhua>
I, [2014-08-28T09:46:56.761651 #2474]  INFO -- : 
I, [2014-08-28T09:46:56.761791 #2474]  INFO -- : Cloning into '/var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140828-2474-q492sn/git_root'...

I, [2014-08-28T09:46:56.774244 #2474]  INFO -- : 
I, [2014-08-28T09:46:56.774433 #2474]  INFO -- : 
I, [2014-08-28T09:46:56.775052 #2474]  INFO -- : Downloading your gems via Spitball server spitball.local.twitter.com...
I, [2014-08-28T09:46:57.805659 #2474]  INFO -- : 
I, [2014-08-28T09:46:57.805828 #2474]  INFO -- : 
I, [2014-08-28T09:46:57.822711 #2474]  INFO -- : /var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140828-2474-q492sn/uileaderboard/config.mesos
I, [2014-08-28T09:46:57.824372 #2474]  INFO -- : # Generated by hayaku v3.13.4

import os

# Note: Packer.install inherits role from the job that runs it, and version's default is 'live'.

# Fetch dependencies
get_application = Packer.install('uileaderboard', version='latest')
get_ruby_1_9 = Packer.install('ruby-1_9_3-p484_shar', role = 'translate', version = 'live')
get_ruby_2_0 = Packer.install('ruby-2_0_0-p481_shar', role = 'translate', version = 'live')
get_ruby_2_1 = Packer.install('ruby-2_1_2_shar', role = 'translate', version = 'live')
get_nodejs = Packer.install('nodejs', role='mesos')
get_nginx = Packer.install('nginx_1_3_14', role = 'trix', version = 'latest')

mysql = Packer.install('mysql-5_5_23_t6_1', role = 'translate', version = 'live')

env = {"IS_MESOS":"1","GEM_HOME":"`pwd`/ruby_vendor/ruby/1.9.1/","LD_LIBRARY_PATH":"`pwd`/mysql/lib","PATH":"`pwd`/node_js/usr/local/bin:/opt/local/bin/:$PATH","RAILS_ENV":"production","RACK_ENV":"production","rvm_path":"./rvm"}


ruby_announcer = Process(
  name = 'ruby_announcer',
  cmdline = """/bin/bash ./run_ruby_announcer.sh announce sdzookeeper.local.twitter.com:2181/twitter/service/yhua/devel/uileaderboard {{mesos.instance}} HOST_NAME:{{thermos.ports[http]}} '{"aurora":"HOST_NAME:{{thermos.ports[http]}}","http":"HOST_NAME:{{thermos.ports[http]}}","health":"HOST_NAME:{{thermos.ports[http]}}"}' -u yhua:yhua""",
  daemon = True,
  max_failures = 100,
  ephemeral = True
)


run_uileaderboard = Process(
  name = 'run_uileaderboard',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"web\"')
)


run_uileaderboard_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


run_uileaderboard_scheduler = Process(
  name = 'run_uileaderboard_scheduler',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"scheduler\"')
)


run_uileaderboard_scheduler_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


update_config = UpdateConfig(
  batch_size = 1,
  restart_threshold = (60 + 10 * 6 + 2),
  watch_secs = (60 + 10 * 6 + 1)
)

health_config = HealthCheckConfig(
  initial_interval_secs=60,
  interval_secs = 10,
  timeout_secs = 10,
  max_consecutive_failures = 6
)

health_announcer = Announcer(
  portmap = {
    'health':'http',
    'aurora':'http'
  }
)

jobs = [
  Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_task,
    name='uileaderboard',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
  , Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_scheduler_task,
    name='uileaderboard_scheduler',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
]

I, [2014-08-28T09:47:25.457927 #2474]  INFO -- : Package added:
Version: 9
History:
  moved to state PRESENT by yhua on 08/28/2014 16:47:22 UTC

I, [2014-08-28T09:47:25.458091 #2474]  INFO -- : Writing log files to disk in /var/tmp

I, [2014-08-28T09:47:38.137736 #2474]  INFO -- : 
I, [2014-08-28T09:47:38.137924 #2474]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard_scheduler
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-28T09:47:38.278646 #2474]  INFO -- : 
I, [2014-08-28T09:47:38.278866 #2474]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-28T09:50:24.795338 #2474]  INFO -- : 
I, [2014-08-28T09:50:24.795503 #2474]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard. Updating existing job
 INFO] Updating job: uileaderboard
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard

I, [2014-08-28T09:50:24.894823 #2474]  INFO -- : 
I, [2014-08-28T09:50:24.894919 #2474]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard_scheduler
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard_scheduler
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard_scheduler. Updating existing job
 INFO] Updating job: uileaderboard_scheduler
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard_scheduler

I, [2014-08-28T09:50:24.928481 #2474]  INFO -- : App: uileaderboard production branch: master succesfully deployed to http://uileaderboard.devel.yhua.service.smf1.twitter.com
I, [2014-08-28T10:15:10.778939 #2805]  INFO -- : Changeset: 478f0b5 - small changes of boardTree.html UI (48 seconds ago) <yingyanhua>
I, [2014-08-28T10:15:11.893458 #2805]  INFO -- : 
I, [2014-08-28T10:15:11.893648 #2805]  INFO -- : Cloning into '/var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140828-2805-4e33se/git_root'...

I, [2014-08-28T10:15:11.907453 #2805]  INFO -- : 
I, [2014-08-28T10:15:11.907613 #2805]  INFO -- : 
I, [2014-08-28T10:15:11.908147 #2805]  INFO -- : Downloading your gems via Spitball server spitball.local.twitter.com...
I, [2014-08-28T10:15:12.917841 #2805]  INFO -- : 
I, [2014-08-28T10:15:12.918035 #2805]  INFO -- : 
I, [2014-08-28T10:15:12.933051 #2805]  INFO -- : /var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140828-2805-4e33se/uileaderboard/config.mesos
I, [2014-08-28T10:15:12.934709 #2805]  INFO -- : # Generated by hayaku v3.13.4

import os

# Note: Packer.install inherits role from the job that runs it, and version's default is 'live'.

# Fetch dependencies
get_application = Packer.install('uileaderboard', version='latest')
get_ruby_1_9 = Packer.install('ruby-1_9_3-p484_shar', role = 'translate', version = 'live')
get_ruby_2_0 = Packer.install('ruby-2_0_0-p481_shar', role = 'translate', version = 'live')
get_ruby_2_1 = Packer.install('ruby-2_1_2_shar', role = 'translate', version = 'live')
get_nodejs = Packer.install('nodejs', role='mesos')
get_nginx = Packer.install('nginx_1_3_14', role = 'trix', version = 'latest')

mysql = Packer.install('mysql-5_5_23_t6_1', role = 'translate', version = 'live')

env = {"IS_MESOS":"1","GEM_HOME":"`pwd`/ruby_vendor/ruby/1.9.1/","LD_LIBRARY_PATH":"`pwd`/mysql/lib","PATH":"`pwd`/node_js/usr/local/bin:/opt/local/bin/:$PATH","RAILS_ENV":"production","RACK_ENV":"production","rvm_path":"./rvm"}


ruby_announcer = Process(
  name = 'ruby_announcer',
  cmdline = """/bin/bash ./run_ruby_announcer.sh announce sdzookeeper.local.twitter.com:2181/twitter/service/yhua/devel/uileaderboard {{mesos.instance}} HOST_NAME:{{thermos.ports[http]}} '{"aurora":"HOST_NAME:{{thermos.ports[http]}}","http":"HOST_NAME:{{thermos.ports[http]}}","health":"HOST_NAME:{{thermos.ports[http]}}"}' -u yhua:yhua""",
  daemon = True,
  max_failures = 100,
  ephemeral = True
)


run_uileaderboard = Process(
  name = 'run_uileaderboard',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"web\"')
)


run_uileaderboard_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


run_uileaderboard_scheduler = Process(
  name = 'run_uileaderboard_scheduler',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"scheduler\"')
)


run_uileaderboard_scheduler_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


update_config = UpdateConfig(
  batch_size = 1,
  restart_threshold = (60 + 10 * 6 + 2),
  watch_secs = (60 + 10 * 6 + 1)
)

health_config = HealthCheckConfig(
  initial_interval_secs=60,
  interval_secs = 10,
  timeout_secs = 10,
  max_consecutive_failures = 6
)

health_announcer = Announcer(
  portmap = {
    'health':'http',
    'aurora':'http'
  }
)

jobs = [
  Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_task,
    name='uileaderboard',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
  , Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_scheduler_task,
    name='uileaderboard_scheduler',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
]

I, [2014-08-28T10:15:30.999479 #2805]  INFO -- : Package added:
Version: 10
History:
  moved to state PRESENT by yhua on 08/28/2014 17:15:27 UTC

I, [2014-08-28T10:15:30.999697 #2805]  INFO -- : Writing log files to disk in /var/tmp

I, [2014-08-28T10:15:43.632304 #2805]  INFO -- : 
I, [2014-08-28T10:15:43.632498 #2805]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-28T10:15:43.778406 #2805]  INFO -- : 
I, [2014-08-28T10:15:43.778578 #2805]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard_scheduler
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-28T10:18:28.145968 #2805]  INFO -- : 
I, [2014-08-28T10:18:28.146139 #2805]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard. Updating existing job
 INFO] Updating job: uileaderboard
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard

I, [2014-08-28T10:18:30.749945 #2805]  INFO -- : 
I, [2014-08-28T10:18:30.750084 #2805]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard_scheduler
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard_scheduler
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard_scheduler. Updating existing job
 INFO] Updating job: uileaderboard_scheduler
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard_scheduler

I, [2014-08-28T10:18:30.756534 #2805]  INFO -- : App: uileaderboard production branch: master succesfully deployed to http://uileaderboard.devel.yhua.service.smf1.twitter.com
I, [2014-08-28T11:33:44.751917 #3326]  INFO -- : Changeset: 2b531fa - add README (44 seconds ago) <yingyanhua>
I, [2014-08-28T11:33:45.820734 #3326]  INFO -- : 
I, [2014-08-28T11:33:45.820937 #3326]  INFO -- : Cloning into '/var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140828-3326-ggw0j6/git_root'...

I, [2014-08-28T11:33:45.833363 #3326]  INFO -- : 
I, [2014-08-28T11:33:45.833544 #3326]  INFO -- : 
I, [2014-08-28T11:33:45.834221 #3326]  INFO -- : Downloading your gems via Spitball server spitball.local.twitter.com...
I, [2014-08-28T11:33:46.800108 #3326]  INFO -- : 
I, [2014-08-28T11:33:46.800303 #3326]  INFO -- : 
I, [2014-08-28T11:33:46.815563 #3326]  INFO -- : /var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140828-3326-ggw0j6/uileaderboard/config.mesos
I, [2014-08-28T11:33:46.817179 #3326]  INFO -- : # Generated by hayaku v3.13.4

import os

# Note: Packer.install inherits role from the job that runs it, and version's default is 'live'.

# Fetch dependencies
get_application = Packer.install('uileaderboard', version='latest')
get_ruby_1_9 = Packer.install('ruby-1_9_3-p484_shar', role = 'translate', version = 'live')
get_ruby_2_0 = Packer.install('ruby-2_0_0-p481_shar', role = 'translate', version = 'live')
get_ruby_2_1 = Packer.install('ruby-2_1_2_shar', role = 'translate', version = 'live')
get_nodejs = Packer.install('nodejs', role='mesos')
get_nginx = Packer.install('nginx_1_3_14', role = 'trix', version = 'latest')

mysql = Packer.install('mysql-5_5_23_t6_1', role = 'translate', version = 'live')

env = {"IS_MESOS":"1","GEM_HOME":"`pwd`/ruby_vendor/ruby/1.9.1/","LD_LIBRARY_PATH":"`pwd`/mysql/lib","PATH":"`pwd`/node_js/usr/local/bin:/opt/local/bin/:$PATH","RAILS_ENV":"production","RACK_ENV":"production","rvm_path":"./rvm"}


ruby_announcer = Process(
  name = 'ruby_announcer',
  cmdline = """/bin/bash ./run_ruby_announcer.sh announce sdzookeeper.local.twitter.com:2181/twitter/service/yhua/devel/uileaderboard {{mesos.instance}} HOST_NAME:{{thermos.ports[http]}} '{"aurora":"HOST_NAME:{{thermos.ports[http]}}","http":"HOST_NAME:{{thermos.ports[http]}}","health":"HOST_NAME:{{thermos.ports[http]}}"}' -u yhua:yhua""",
  daemon = True,
  max_failures = 100,
  ephemeral = True
)


run_uileaderboard = Process(
  name = 'run_uileaderboard',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"web\"')
)


run_uileaderboard_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


run_uileaderboard_scheduler = Process(
  name = 'run_uileaderboard_scheduler',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"scheduler\"')
)


run_uileaderboard_scheduler_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


update_config = UpdateConfig(
  batch_size = 1,
  restart_threshold = (60 + 10 * 6 + 2),
  watch_secs = (60 + 10 * 6 + 1)
)

health_config = HealthCheckConfig(
  initial_interval_secs=60,
  interval_secs = 10,
  timeout_secs = 10,
  max_consecutive_failures = 6
)

health_announcer = Announcer(
  portmap = {
    'health':'http',
    'aurora':'http'
  }
)

jobs = [
  Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_task,
    name='uileaderboard',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
  , Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_scheduler_task,
    name='uileaderboard_scheduler',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
]

I, [2014-08-28T11:34:06.851078 #3326]  INFO -- : Package added:
Version: 11
History:
  moved to state PRESENT by yhua on 08/28/2014 18:34:03 UTC

I, [2014-08-28T11:34:06.851241 #3326]  INFO -- : Writing log files to disk in /var/tmp

I, [2014-08-28T11:34:20.587298 #3326]  INFO -- : 
I, [2014-08-28T11:34:20.587481 #3326]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard_scheduler
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-28T11:34:20.808651 #3326]  INFO -- : 
I, [2014-08-28T11:34:20.808859 #3326]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-28T11:37:11.452908 #3326]  INFO -- : 
I, [2014-08-28T11:37:11.453164 #3326]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard. Updating existing job
 INFO] Updating job: uileaderboard
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard

I, [2014-08-28T11:37:11.705465 #3326]  INFO -- : 
I, [2014-08-28T11:37:11.705595 #3326]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard_scheduler
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard_scheduler
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard_scheduler. Updating existing job
 INFO] Updating job: uileaderboard_scheduler
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard_scheduler

I, [2014-08-28T11:37:11.711822 #3326]  INFO -- : App: uileaderboard production branch: master succesfully deployed to http://uileaderboard.devel.yhua.service.smf1.twitter.com
I, [2014-08-28T14:14:29.462342 #4222]  INFO -- : Changeset: 02755a5 - maybe fix a bug (37 seconds ago) <yingyanhua>
I, [2014-08-28T14:14:30.420521 #4222]  INFO -- : 
I, [2014-08-28T14:14:30.420666 #4222]  INFO -- : Cloning into '/var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140828-4222-1yebxvj/git_root'...

I, [2014-08-28T14:14:30.433551 #4222]  INFO -- : 
I, [2014-08-28T14:14:30.433667 #4222]  INFO -- : 
I, [2014-08-28T14:14:30.434224 #4222]  INFO -- : Downloading your gems via Spitball server spitball.local.twitter.com...
I, [2014-08-28T14:14:31.464493 #4222]  INFO -- : 
I, [2014-08-28T14:14:31.464680 #4222]  INFO -- : 
I, [2014-08-28T14:14:31.481902 #4222]  INFO -- : /var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140828-4222-1yebxvj/uileaderboard/config.mesos
I, [2014-08-28T14:14:31.483699 #4222]  INFO -- : # Generated by hayaku v3.13.4

import os

# Note: Packer.install inherits role from the job that runs it, and version's default is 'live'.

# Fetch dependencies
get_application = Packer.install('uileaderboard', version='latest')
get_ruby_1_9 = Packer.install('ruby-1_9_3-p484_shar', role = 'translate', version = 'live')
get_ruby_2_0 = Packer.install('ruby-2_0_0-p481_shar', role = 'translate', version = 'live')
get_ruby_2_1 = Packer.install('ruby-2_1_2_shar', role = 'translate', version = 'live')
get_nodejs = Packer.install('nodejs', role='mesos')
get_nginx = Packer.install('nginx_1_3_14', role = 'trix', version = 'latest')

mysql = Packer.install('mysql-5_5_23_t6_1', role = 'translate', version = 'live')

env = {"IS_MESOS":"1","GEM_HOME":"`pwd`/ruby_vendor/ruby/1.9.1/","LD_LIBRARY_PATH":"`pwd`/mysql/lib","PATH":"`pwd`/node_js/usr/local/bin:/opt/local/bin/:$PATH","RAILS_ENV":"production","RACK_ENV":"production","rvm_path":"./rvm"}


ruby_announcer = Process(
  name = 'ruby_announcer',
  cmdline = """/bin/bash ./run_ruby_announcer.sh announce sdzookeeper.local.twitter.com:2181/twitter/service/yhua/devel/uileaderboard {{mesos.instance}} HOST_NAME:{{thermos.ports[http]}} '{"aurora":"HOST_NAME:{{thermos.ports[http]}}","http":"HOST_NAME:{{thermos.ports[http]}}","health":"HOST_NAME:{{thermos.ports[http]}}"}' -u yhua:yhua""",
  daemon = True,
  max_failures = 100,
  ephemeral = True
)


run_uileaderboard = Process(
  name = 'run_uileaderboard',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"web\"')
)


run_uileaderboard_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


run_uileaderboard_scheduler = Process(
  name = 'run_uileaderboard_scheduler',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"scheduler\"')
)


run_uileaderboard_scheduler_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


update_config = UpdateConfig(
  batch_size = 1,
  restart_threshold = (60 + 10 * 6 + 2),
  watch_secs = (60 + 10 * 6 + 1)
)

health_config = HealthCheckConfig(
  initial_interval_secs=60,
  interval_secs = 10,
  timeout_secs = 10,
  max_consecutive_failures = 6
)

health_announcer = Announcer(
  portmap = {
    'health':'http',
    'aurora':'http'
  }
)

jobs = [
  Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_task,
    name='uileaderboard',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
  , Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_scheduler_task,
    name='uileaderboard_scheduler',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
]

I, [2014-08-28T14:14:51.155490 #4222]  INFO -- : Package added:
Version: 12
History:
  moved to state PRESENT by yhua on 08/28/2014 21:14:48 UTC

I, [2014-08-28T14:14:51.155758 #4222]  INFO -- : Writing log files to disk in /var/tmp

I, [2014-08-28T14:15:03.774177 #4222]  INFO -- : 
I, [2014-08-28T14:15:03.774375 #4222]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard_scheduler
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-28T14:15:03.777152 #4222]  INFO -- : 
I, [2014-08-28T14:15:03.777321 #4222]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-28T14:17:50.985224 #4222]  INFO -- : 
I, [2014-08-28T14:17:50.985444 #4222]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard. Updating existing job
 INFO] Updating job: uileaderboard
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard

I, [2014-08-28T14:17:50.987610 #4222]  INFO -- : 
I, [2014-08-28T14:17:50.987754 #4222]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard_scheduler
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard_scheduler
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard_scheduler. Updating existing job
 INFO] Updating job: uileaderboard_scheduler
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard_scheduler

I, [2014-08-28T14:17:50.994178 #4222]  INFO -- : App: uileaderboard production branch: master succesfully deployed to http://uileaderboard.devel.yhua.service.smf1.twitter.com
I, [2014-08-28T17:23:05.834712 #6130]  INFO -- : Changeset: 27eaa31 - change some styles and can scroll the tree now (41 seconds ago) <yingyanhua>
I, [2014-08-28T17:23:06.950633 #6130]  INFO -- : 
I, [2014-08-28T17:23:06.950803 #6130]  INFO -- : Cloning into '/var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140828-6130-1e9olmt/git_root'...

I, [2014-08-28T17:23:06.964104 #6130]  INFO -- : 
I, [2014-08-28T17:23:06.964290 #6130]  INFO -- : 
I, [2014-08-28T17:23:06.964944 #6130]  INFO -- : Downloading your gems via Spitball server spitball.local.twitter.com...
I, [2014-08-28T17:23:07.900391 #6130]  INFO -- : 
I, [2014-08-28T17:23:07.900797 #6130]  INFO -- : 
I, [2014-08-28T17:23:07.916170 #6130]  INFO -- : /var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140828-6130-1e9olmt/uileaderboard/config.mesos
I, [2014-08-28T17:23:07.918275 #6130]  INFO -- : # Generated by hayaku v3.13.4

import os

# Note: Packer.install inherits role from the job that runs it, and version's default is 'live'.

# Fetch dependencies
get_application = Packer.install('uileaderboard', version='latest')
get_ruby_1_9 = Packer.install('ruby-1_9_3-p484_shar', role = 'translate', version = 'live')
get_ruby_2_0 = Packer.install('ruby-2_0_0-p481_shar', role = 'translate', version = 'live')
get_ruby_2_1 = Packer.install('ruby-2_1_2_shar', role = 'translate', version = 'live')
get_nodejs = Packer.install('nodejs', role='mesos')
get_nginx = Packer.install('nginx_1_3_14', role = 'trix', version = 'latest')

mysql = Packer.install('mysql-5_5_23_t6_1', role = 'translate', version = 'live')

env = {"IS_MESOS":"1","GEM_HOME":"`pwd`/ruby_vendor/ruby/1.9.1/","LD_LIBRARY_PATH":"`pwd`/mysql/lib","PATH":"`pwd`/node_js/usr/local/bin:/opt/local/bin/:$PATH","RAILS_ENV":"production","RACK_ENV":"production","rvm_path":"./rvm"}


ruby_announcer = Process(
  name = 'ruby_announcer',
  cmdline = """/bin/bash ./run_ruby_announcer.sh announce sdzookeeper.local.twitter.com:2181/twitter/service/yhua/devel/uileaderboard {{mesos.instance}} HOST_NAME:{{thermos.ports[http]}} '{"aurora":"HOST_NAME:{{thermos.ports[http]}}","http":"HOST_NAME:{{thermos.ports[http]}}","health":"HOST_NAME:{{thermos.ports[http]}}"}' -u yhua:yhua""",
  daemon = True,
  max_failures = 100,
  ephemeral = True
)


run_uileaderboard = Process(
  name = 'run_uileaderboard',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"web\"')
)


run_uileaderboard_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


run_uileaderboard_scheduler = Process(
  name = 'run_uileaderboard_scheduler',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"scheduler\"')
)


run_uileaderboard_scheduler_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


update_config = UpdateConfig(
  batch_size = 1,
  restart_threshold = (60 + 10 * 6 + 2),
  watch_secs = (60 + 10 * 6 + 1)
)

health_config = HealthCheckConfig(
  initial_interval_secs=60,
  interval_secs = 10,
  timeout_secs = 10,
  max_consecutive_failures = 6
)

health_announcer = Announcer(
  portmap = {
    'health':'http',
    'aurora':'http'
  }
)

jobs = [
  Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_task,
    name='uileaderboard',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
  , Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_scheduler_task,
    name='uileaderboard_scheduler',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
]

I, [2014-08-28T17:23:24.369441 #6130]  INFO -- : Package added:
Version: 13
History:
  moved to state PRESENT by yhua on 08/29/2014 00:23:22 UTC

I, [2014-08-28T17:23:24.369613 #6130]  INFO -- : Writing log files to disk in /var/tmp

I, [2014-08-28T17:23:36.990765 #6130]  INFO -- : 
I, [2014-08-28T17:23:36.990941 #6130]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard_scheduler
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-28T17:23:37.081914 #6130]  INFO -- : 
I, [2014-08-28T17:23:37.082135 #6130]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-28T17:26:20.341563 #6130]  INFO -- : 
I, [2014-08-28T17:26:20.341773 #6130]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard. Updating existing job
 INFO] Updating job: uileaderboard
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard

I, [2014-08-28T17:26:23.790825 #6130]  INFO -- : 
I, [2014-08-28T17:26:23.790992 #6130]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard_scheduler
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard_scheduler
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard_scheduler. Updating existing job
 INFO] Updating job: uileaderboard_scheduler
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard_scheduler

I, [2014-08-28T17:26:23.800147 #6130]  INFO -- : App: uileaderboard production branch: master succesfully deployed to http://uileaderboard.devel.yhua.service.smf1.twitter.com
I, [2014-08-29T09:24:20.754340 #6566]  INFO -- : Changeset: c20a996 - can show name completely and change the fontsize (49 seconds ago) <yingyanhua>
I, [2014-08-29T09:24:21.938496 #6566]  INFO -- : 
I, [2014-08-29T09:24:21.938680 #6566]  INFO -- : Cloning into '/var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140829-6566-m3wjhg/git_root'...

I, [2014-08-29T09:24:21.953084 #6566]  INFO -- : 
I, [2014-08-29T09:24:21.953263 #6566]  INFO -- : 
I, [2014-08-29T09:24:21.953800 #6566]  INFO -- : Downloading your gems via Spitball server spitball.local.twitter.com...
I, [2014-08-29T09:24:22.928469 #6566]  INFO -- : 
I, [2014-08-29T09:24:22.928757 #6566]  INFO -- : 
I, [2014-08-29T09:24:22.945843 #6566]  INFO -- : /var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140829-6566-m3wjhg/uileaderboard/config.mesos
I, [2014-08-29T09:24:22.948047 #6566]  INFO -- : # Generated by hayaku v3.13.4

import os

# Note: Packer.install inherits role from the job that runs it, and version's default is 'live'.

# Fetch dependencies
get_application = Packer.install('uileaderboard', version='latest')
get_ruby_1_9 = Packer.install('ruby-1_9_3-p484_shar', role = 'translate', version = 'live')
get_ruby_2_0 = Packer.install('ruby-2_0_0-p481_shar', role = 'translate', version = 'live')
get_ruby_2_1 = Packer.install('ruby-2_1_2_shar', role = 'translate', version = 'live')
get_nodejs = Packer.install('nodejs', role='mesos')
get_nginx = Packer.install('nginx_1_3_14', role = 'trix', version = 'latest')

mysql = Packer.install('mysql-5_5_23_t6_1', role = 'translate', version = 'live')

env = {"IS_MESOS":"1","GEM_HOME":"`pwd`/ruby_vendor/ruby/1.9.1/","LD_LIBRARY_PATH":"`pwd`/mysql/lib","PATH":"`pwd`/node_js/usr/local/bin:/opt/local/bin/:$PATH","RAILS_ENV":"production","RACK_ENV":"production","rvm_path":"./rvm"}


ruby_announcer = Process(
  name = 'ruby_announcer',
  cmdline = """/bin/bash ./run_ruby_announcer.sh announce sdzookeeper.local.twitter.com:2181/twitter/service/yhua/devel/uileaderboard {{mesos.instance}} HOST_NAME:{{thermos.ports[http]}} '{"aurora":"HOST_NAME:{{thermos.ports[http]}}","http":"HOST_NAME:{{thermos.ports[http]}}","health":"HOST_NAME:{{thermos.ports[http]}}"}' -u yhua:yhua""",
  daemon = True,
  max_failures = 100,
  ephemeral = True
)


run_uileaderboard = Process(
  name = 'run_uileaderboard',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"web\"')
)


run_uileaderboard_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


run_uileaderboard_scheduler = Process(
  name = 'run_uileaderboard_scheduler',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"scheduler\"')
)


run_uileaderboard_scheduler_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


update_config = UpdateConfig(
  batch_size = 1,
  restart_threshold = (60 + 10 * 6 + 2),
  watch_secs = (60 + 10 * 6 + 1)
)

health_config = HealthCheckConfig(
  initial_interval_secs=60,
  interval_secs = 10,
  timeout_secs = 10,
  max_consecutive_failures = 6
)

health_announcer = Announcer(
  portmap = {
    'health':'http',
    'aurora':'http'
  }
)

jobs = [
  Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_task,
    name='uileaderboard',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
  , Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_scheduler_task,
    name='uileaderboard_scheduler',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
]

I, [2014-08-29T09:24:39.620882 #6566]  INFO -- : Package added:
Version: 14
History:
  moved to state PRESENT by yhua on 08/29/2014 16:24:35 UTC

I, [2014-08-29T09:24:39.621112 #6566]  INFO -- : Writing log files to disk in /var/tmp

I, [2014-08-29T09:24:52.196152 #6566]  INFO -- : 
I, [2014-08-29T09:24:52.196316 #6566]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-29T09:24:52.251191 #6566]  INFO -- : 
I, [2014-08-29T09:24:52.251362 #6566]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard_scheduler
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-29T09:27:36.878995 #6566]  INFO -- : 
I, [2014-08-29T09:27:36.879179 #6566]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard_scheduler
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard_scheduler
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard_scheduler. Updating existing job
 INFO] Updating job: uileaderboard_scheduler
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard_scheduler

I, [2014-08-29T09:27:37.023234 #6566]  INFO -- : 
I, [2014-08-29T09:27:37.023345 #6566]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard. Updating existing job
 INFO] Updating job: uileaderboard
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard

I, [2014-08-29T09:27:37.030419 #6566]  INFO -- : App: uileaderboard production branch: master succesfully deployed to http://uileaderboard.devel.yhua.service.smf1.twitter.com
I, [2014-08-29T14:29:13.123488 #32875]  INFO -- : Changeset: 06999a1 - modify README (44 seconds ago) <yingyanhua>
I, [2014-08-29T14:29:14.223291 #32875]  INFO -- : 
I, [2014-08-29T14:29:14.223493 #32875]  INFO -- : Cloning into '/var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140829-32875-ylk0nh/git_root'...

I, [2014-08-29T14:29:14.237861 #32875]  INFO -- : 
I, [2014-08-29T14:29:14.238238 #32875]  INFO -- : 
I, [2014-08-29T14:29:14.239417 #32875]  INFO -- : Downloading your gems via Spitball server spitball.local.twitter.com...
I, [2014-08-29T14:29:15.383820 #32875]  INFO -- : 
I, [2014-08-29T14:29:15.384037 #32875]  INFO -- : 
I, [2014-08-29T14:29:15.396350 #32875]  INFO -- : /var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140829-32875-ylk0nh/uileaderboard/config.mesos
I, [2014-08-29T14:29:15.399095 #32875]  INFO -- : # Generated by hayaku v3.13.4

import os

# Note: Packer.install inherits role from the job that runs it, and version's default is 'live'.

# Fetch dependencies
get_application = Packer.install('uileaderboard', version='latest')
get_ruby_1_9 = Packer.install('ruby-1_9_3-p484_shar', role = 'translate', version = 'live')
get_ruby_2_0 = Packer.install('ruby-2_0_0-p481_shar', role = 'translate', version = 'live')
get_ruby_2_1 = Packer.install('ruby-2_1_2_shar', role = 'translate', version = 'live')
get_nodejs = Packer.install('nodejs', role='mesos')
get_nginx = Packer.install('nginx_1_3_14', role = 'trix', version = 'latest')

mysql = Packer.install('mysql-5_5_23_t6_1', role = 'translate', version = 'live')

env = {"IS_MESOS":"1","GEM_HOME":"`pwd`/ruby_vendor/ruby/1.9.1/","LD_LIBRARY_PATH":"`pwd`/mysql/lib","PATH":"`pwd`/node_js/usr/local/bin:/opt/local/bin/:$PATH","RAILS_ENV":"production","RACK_ENV":"production","rvm_path":"./rvm"}


ruby_announcer = Process(
  name = 'ruby_announcer',
  cmdline = """/bin/bash ./run_ruby_announcer.sh announce sdzookeeper.local.twitter.com:2181/twitter/service/yhua/devel/uileaderboard {{mesos.instance}} HOST_NAME:{{thermos.ports[http]}} '{"aurora":"HOST_NAME:{{thermos.ports[http]}}","http":"HOST_NAME:{{thermos.ports[http]}}","health":"HOST_NAME:{{thermos.ports[http]}}"}' -u yhua:yhua""",
  daemon = True,
  max_failures = 100,
  ephemeral = True
)


run_uileaderboard = Process(
  name = 'run_uileaderboard',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"web\"')
)


run_uileaderboard_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


run_uileaderboard_scheduler = Process(
  name = 'run_uileaderboard_scheduler',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"scheduler\"')
)


run_uileaderboard_scheduler_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


update_config = UpdateConfig(
  batch_size = 1,
  restart_threshold = (60 + 10 * 6 + 2),
  watch_secs = (60 + 10 * 6 + 1)
)

health_config = HealthCheckConfig(
  initial_interval_secs=60,
  interval_secs = 10,
  timeout_secs = 10,
  max_consecutive_failures = 6
)

health_announcer = Announcer(
  portmap = {
    'health':'http',
    'aurora':'http'
  }
)

jobs = [
  Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_task,
    name='uileaderboard',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
  , Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_scheduler_task,
    name='uileaderboard_scheduler',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
]

I, [2014-08-29T14:29:32.212996 #32875]  INFO -- : Package added:
Version: 15
History:
  moved to state PRESENT by yhua on 08/29/2014 21:29:30 UTC

I, [2014-08-29T14:29:32.213222 #32875]  INFO -- : Writing log files to disk in /var/tmp

I, [2014-08-29T14:29:44.830651 #32875]  INFO -- : 
I, [2014-08-29T14:29:44.830943 #32875]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard_scheduler
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-29T14:29:44.903443 #32875]  INFO -- : 
I, [2014-08-29T14:29:44.903646 #32875]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard
 INFO] Response from scheduler: OK (message: None)

I, [2014-08-29T14:32:35.866490 #32875]  INFO -- : 
I, [2014-08-29T14:32:35.866634 #32875]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard. Updating existing job
 INFO] Updating job: uileaderboard
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard

I, [2014-08-29T14:32:37.356526 #32875]  INFO -- : 
I, [2014-08-29T14:32:37.356675 #32875]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard_scheduler
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard_scheduler
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard_scheduler. Updating existing job
 INFO] Updating job: uileaderboard_scheduler
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard_scheduler

I, [2014-08-29T14:32:37.363124 #32875]  INFO -- : App: uileaderboard production branch: master succesfully deployed to http://uileaderboard.devel.yhua.service.smf1.twitter.com
I, [2014-09-02T17:04:14.516955 #37592]  INFO -- : Changeset: 6e33b9b - add low-level design notes. (54 seconds ago) <yingyanhua>
I, [2014-09-02T17:04:15.641223 #37592]  INFO -- : 
I, [2014-09-02T17:04:15.641404 #37592]  INFO -- : Cloning into '/var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140902-37592-1vd99vp/git_root'...

I, [2014-09-02T17:04:15.654668 #37592]  INFO -- : 
I, [2014-09-02T17:04:15.654848 #37592]  INFO -- : 
I, [2014-09-02T17:04:15.656000 #37592]  INFO -- : Downloading your gems via Spitball server spitball.local.twitter.com...
I, [2014-09-02T17:04:16.734901 #37592]  INFO -- : 
I, [2014-09-02T17:04:16.735083 #37592]  INFO -- : 
I, [2014-09-02T17:04:16.754269 #37592]  INFO -- : /var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140902-37592-1vd99vp/uileaderboard/config.mesos
I, [2014-09-02T17:04:16.756128 #37592]  INFO -- : # Generated by hayaku v3.13.4

import os

# Note: Packer.install inherits role from the job that runs it, and version's default is 'live'.

# Fetch dependencies
get_application = Packer.install('uileaderboard', version='latest')
get_ruby_1_9 = Packer.install('ruby-1_9_3-p484_shar', role = 'translate', version = 'live')
get_ruby_2_0 = Packer.install('ruby-2_0_0-p481_shar', role = 'translate', version = 'live')
get_ruby_2_1 = Packer.install('ruby-2_1_2_shar', role = 'translate', version = 'live')
get_nodejs = Packer.install('nodejs', role='mesos')
get_nginx = Packer.install('nginx_1_3_14', role = 'trix', version = 'latest')

mysql = Packer.install('mysql-5_5_23_t6_1', role = 'translate', version = 'live')

env = {"IS_MESOS":"1","GEM_HOME":"`pwd`/ruby_vendor/ruby/1.9.1/","LD_LIBRARY_PATH":"`pwd`/mysql/lib","PATH":"`pwd`/node_js/usr/local/bin:/opt/local/bin/:$PATH","RAILS_ENV":"production","RACK_ENV":"production","rvm_path":"./rvm"}


ruby_announcer = Process(
  name = 'ruby_announcer',
  cmdline = """/bin/bash ./run_ruby_announcer.sh announce sdzookeeper.local.twitter.com:2181/twitter/service/yhua/devel/uileaderboard {{mesos.instance}} HOST_NAME:{{thermos.ports[http]}} '{"aurora":"HOST_NAME:{{thermos.ports[http]}}","http":"HOST_NAME:{{thermos.ports[http]}}","health":"HOST_NAME:{{thermos.ports[http]}}"}' -u yhua:yhua""",
  daemon = True,
  max_failures = 100,
  ephemeral = True
)


run_uileaderboard = Process(
  name = 'run_uileaderboard',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"web\"')
)


run_uileaderboard_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


run_uileaderboard_scheduler = Process(
  name = 'run_uileaderboard_scheduler',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"scheduler\"')
)


run_uileaderboard_scheduler_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


update_config = UpdateConfig(
  batch_size = 1,
  restart_threshold = (60 + 10 * 6 + 2),
  watch_secs = (60 + 10 * 6 + 1)
)

health_config = HealthCheckConfig(
  initial_interval_secs=60,
  interval_secs = 10,
  timeout_secs = 10,
  max_consecutive_failures = 6
)

health_announcer = Announcer(
  portmap = {
    'health':'http',
    'aurora':'http'
  }
)

jobs = [
  Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_task,
    name='uileaderboard',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
  , Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_scheduler_task,
    name='uileaderboard_scheduler',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
]

I, [2014-09-02T17:04:35.664508 #37592]  INFO -- : Package added:
Version: 16
History:
  moved to state PRESENT by yhua on 09/03/2014 00:04:34 UTC

I, [2014-09-02T17:04:35.664663 #37592]  INFO -- : Writing log files to disk in /var/tmp

I, [2014-09-02T17:04:48.758612 #37592]  INFO -- : 
I, [2014-09-02T17:04:48.758773 #37592]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard
 INFO] Response from scheduler: OK (message: None)

I, [2014-09-02T17:04:52.456290 #37592]  INFO -- : 
I, [2014-09-02T17:04:52.456487 #37592]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard_scheduler
 INFO] Response from scheduler: OK (message: None)

I, [2014-09-02T17:07:56.218030 #37592]  INFO -- : 
I, [2014-09-02T17:07:56.218222 #37592]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard_scheduler
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard_scheduler
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard_scheduler. Updating existing job
 INFO] Updating job: uileaderboard_scheduler
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard_scheduler

I, [2014-09-02T17:07:59.774528 #37592]  INFO -- : 
I, [2014-09-02T17:07:59.774662 #37592]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard. Updating existing job
 INFO] Updating job: uileaderboard
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard

I, [2014-09-02T17:07:59.781290 #37592]  INFO -- : App: uileaderboard production branch: master succesfully deployed to http://uileaderboard.devel.yhua.service.smf1.twitter.com
I, [2014-09-03T16:53:36.849728 #41328]  INFO -- : Changeset: 7b88a8b - add data structure description in README (45 seconds ago) <yingyanhua>
I, [2014-09-03T16:53:37.884995 #41328]  INFO -- : 
I, [2014-09-03T16:53:37.885189 #41328]  INFO -- : Cloning into '/var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140903-41328-1ubbnvb/git_root'...

I, [2014-09-03T16:53:37.899183 #41328]  INFO -- : 
I, [2014-09-03T16:53:37.899357 #41328]  INFO -- : 
I, [2014-09-03T16:53:37.900672 #41328]  INFO -- : Downloading your gems via Spitball server spitball.local.twitter.com...
I, [2014-09-03T16:53:38.967013 #41328]  INFO -- : 
I, [2014-09-03T16:53:38.967207 #41328]  INFO -- : 
I, [2014-09-03T16:53:38.985095 #41328]  INFO -- : /var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140903-41328-1ubbnvb/uileaderboard/config.mesos
I, [2014-09-03T16:53:38.986859 #41328]  INFO -- : # Generated by hayaku v3.13.4

import os

# Note: Packer.install inherits role from the job that runs it, and version's default is 'live'.

# Fetch dependencies
get_application = Packer.install('uileaderboard', version='latest')
get_ruby_1_9 = Packer.install('ruby-1_9_3-p484_shar', role = 'translate', version = 'live')
get_ruby_2_0 = Packer.install('ruby-2_0_0-p481_shar', role = 'translate', version = 'live')
get_ruby_2_1 = Packer.install('ruby-2_1_2_shar', role = 'translate', version = 'live')
get_nodejs = Packer.install('nodejs', role='mesos')
get_nginx = Packer.install('nginx_1_3_14', role = 'trix', version = 'latest')

mysql = Packer.install('mysql-5_5_23_t6_1', role = 'translate', version = 'live')

env = {"IS_MESOS":"1","GEM_HOME":"`pwd`/ruby_vendor/ruby/1.9.1/","LD_LIBRARY_PATH":"`pwd`/mysql/lib","PATH":"`pwd`/node_js/usr/local/bin:/opt/local/bin/:$PATH","RAILS_ENV":"production","RACK_ENV":"production","rvm_path":"./rvm"}


ruby_announcer = Process(
  name = 'ruby_announcer',
  cmdline = """/bin/bash ./run_ruby_announcer.sh announce sdzookeeper.local.twitter.com:2181/twitter/service/yhua/devel/uileaderboard {{mesos.instance}} HOST_NAME:{{thermos.ports[http]}} '{"aurora":"HOST_NAME:{{thermos.ports[http]}}","http":"HOST_NAME:{{thermos.ports[http]}}","health":"HOST_NAME:{{thermos.ports[http]}}"}' -u yhua:yhua""",
  daemon = True,
  max_failures = 100,
  ephemeral = True
)


run_uileaderboard = Process(
  name = 'run_uileaderboard',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"web\"')
)


run_uileaderboard_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


run_uileaderboard_scheduler = Process(
  name = 'run_uileaderboard_scheduler',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"scheduler\"')
)


run_uileaderboard_scheduler_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


update_config = UpdateConfig(
  batch_size = 1,
  restart_threshold = (60 + 10 * 6 + 2),
  watch_secs = (60 + 10 * 6 + 1)
)

health_config = HealthCheckConfig(
  initial_interval_secs=60,
  interval_secs = 10,
  timeout_secs = 10,
  max_consecutive_failures = 6
)

health_announcer = Announcer(
  portmap = {
    'health':'http',
    'aurora':'http'
  }
)

jobs = [
  Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_task,
    name='uileaderboard',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
  , Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_scheduler_task,
    name='uileaderboard_scheduler',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
]

I, [2014-09-03T16:53:56.252145 #41328]  INFO -- : Package added:
Version: 17
History:
  moved to state PRESENT by yhua on 09/03/2014 23:53:54 UTC

I, [2014-09-03T16:53:56.252341 #41328]  INFO -- : Writing log files to disk in /var/tmp

I, [2014-09-03T16:54:09.980500 #41328]  INFO -- : 
I, [2014-09-03T16:54:09.980707 #41328]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard
 INFO] Response from scheduler: OK (message: None)

I, [2014-09-03T16:54:09.983586 #41328]  INFO -- : 
I, [2014-09-03T16:54:09.983787 #41328]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard_scheduler
 INFO] Response from scheduler: OK (message: None)

I, [2014-09-03T16:57:18.219642 #41328]  INFO -- : 
I, [2014-09-03T16:57:18.219836 #41328]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard_scheduler
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard_scheduler
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard_scheduler. Updating existing job
 INFO] Updating job: uileaderboard_scheduler
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard_scheduler

I, [2014-09-03T16:57:21.303952 #41328]  INFO -- : 
I, [2014-09-03T16:57:21.304036 #41328]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard. Updating existing job
 INFO] Updating job: uileaderboard
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard

I, [2014-09-03T16:57:21.310541 #41328]  INFO -- : App: uileaderboard production branch: master succesfully deployed to http://uileaderboard.devel.yhua.service.smf1.twitter.com
I, [2014-09-04T10:18:44.294752 #42719]  INFO -- : Changeset: 362e23a - check style, keep js length of each line within 80 except for the drawing-tree part (51 seconds ago) <yingyanhua>
I, [2014-09-04T10:18:45.473327 #42719]  INFO -- : 
I, [2014-09-04T10:18:45.473518 #42719]  INFO -- : Cloning into '/var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140904-42719-1ofcbeb/git_root'...

I, [2014-09-04T10:18:45.487239 #42719]  INFO -- : 
I, [2014-09-04T10:18:45.487415 #42719]  INFO -- : 
I, [2014-09-04T10:18:45.488508 #42719]  INFO -- : Downloading your gems via Spitball server spitball.local.twitter.com...
I, [2014-09-04T10:18:46.469382 #42719]  INFO -- : 
I, [2014-09-04T10:18:46.469563 #42719]  INFO -- : 
I, [2014-09-04T10:18:46.486979 #42719]  INFO -- : /var/folders/bk/158jmm2s11d5y01kx8xq9p400000gn/T/d20140904-42719-1ofcbeb/uileaderboard/config.mesos
I, [2014-09-04T10:18:46.489188 #42719]  INFO -- : # Generated by hayaku v3.13.4

import os

# Note: Packer.install inherits role from the job that runs it, and version's default is 'live'.

# Fetch dependencies
get_application = Packer.install('uileaderboard', version='latest')
get_ruby_1_9 = Packer.install('ruby-1_9_3-p484_shar', role = 'translate', version = 'live')
get_ruby_2_0 = Packer.install('ruby-2_0_0-p481_shar', role = 'translate', version = 'live')
get_ruby_2_1 = Packer.install('ruby-2_1_2_shar', role = 'translate', version = 'live')
get_nodejs = Packer.install('nodejs', role='mesos')
get_nginx = Packer.install('nginx_1_3_14', role = 'trix', version = 'latest')

mysql = Packer.install('mysql-5_5_23_t6_1', role = 'translate', version = 'live')

env = {"IS_MESOS":"1","GEM_HOME":"`pwd`/ruby_vendor/ruby/1.9.1/","LD_LIBRARY_PATH":"`pwd`/mysql/lib","PATH":"`pwd`/node_js/usr/local/bin:/opt/local/bin/:$PATH","RAILS_ENV":"production","RACK_ENV":"production","rvm_path":"./rvm"}


ruby_announcer = Process(
  name = 'ruby_announcer',
  cmdline = """/bin/bash ./run_ruby_announcer.sh announce sdzookeeper.local.twitter.com:2181/twitter/service/yhua/devel/uileaderboard {{mesos.instance}} HOST_NAME:{{thermos.ports[http]}} '{"aurora":"HOST_NAME:{{thermos.ports[http]}}","http":"HOST_NAME:{{thermos.ports[http]}}","health":"HOST_NAME:{{thermos.ports[http]}}"}' -u yhua:yhua""",
  daemon = True,
  max_failures = 100,
  ephemeral = True
)


run_uileaderboard = Process(
  name = 'run_uileaderboard',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"web\"')
)


run_uileaderboard_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


run_uileaderboard_scheduler = Process(
  name = 'run_uileaderboard_scheduler',
  cmdline = ('; '.join('export %s=%s' % (k, v) for k, v in env.iteritems()) + '; '
    + '/usr/local/bin/timeout.py 0 '
    + '/bin/bash ./run_foreman.sh {{thermos.ports[http]}} \"scheduler\"')
)


run_uileaderboard_scheduler_task = Task(
  # Setup the processes to run. These processes are dependent on ruby version, old announcer, etc
  processes = [get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler],
  constraints = order(get_application, get_ruby_1_9, mysql, get_nodejs,    run_uileaderboard_scheduler),
  resources = Resources(cpu=1, ram=1024*MB, disk=1024*MB)
)


update_config = UpdateConfig(
  batch_size = 1,
  restart_threshold = (60 + 10 * 6 + 2),
  watch_secs = (60 + 10 * 6 + 1)
)

health_config = HealthCheckConfig(
  initial_interval_secs=60,
  interval_secs = 10,
  timeout_secs = 10,
  max_consecutive_failures = 6
)

health_announcer = Announcer(
  portmap = {
    'health':'http',
    'aurora':'http'
  }
)

jobs = [
  Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_task,
    name='uileaderboard',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
  , Job(
    cluster='smf1',
    role='yhua',
    service=True,
    task=run_uileaderboard_scheduler_task,
    name='uileaderboard_scheduler',
    instances=1,
    update_config=update_config,
    announce=Announcer(),
    
    environment='devel',
    production=False
  )
]

I, [2014-09-04T10:19:03.221553 #42719]  INFO -- : Package added:
Version: 18
History:
  moved to state PRESENT by yhua on 09/04/2014 17:19:01 UTC

I, [2014-09-04T10:19:03.221749 #42719]  INFO -- : Writing log files to disk in /var/tmp

I, [2014-09-04T10:19:15.913270 #42719]  INFO -- : 
I, [2014-09-04T10:19:15.913482 #42719]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard
 INFO] Response from scheduler: OK (message: None)

I, [2014-09-04T10:19:15.966171 #42719]  INFO -- : 
I, [2014-09-04T10:19:15.966342 #42719]  INFO -- :  INFO] Canceling update on job smf1/yhua/devel/uileaderboard_scheduler
 INFO] Response from scheduler: OK (message: None)

I, [2014-09-04T10:21:59.677259 #42719]  INFO -- : 
I, [2014-09-04T10:21:59.677424 #42719]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard. Updating existing job
 INFO] Updating job: uileaderboard
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard

I, [2014-09-04T10:22:02.704469 #42719]  INFO -- : 
I, [2014-09-04T10:22:02.704596 #42719]  INFO -- :  INFO] Creating deployment configuration: smf1/yhua/devel/uileaderboard_scheduler
 INFO] Fetching metadata for package mesos/nodejs version live in smf1.
 INFO] Fetching metadata for package yhua/uileaderboard version latest in smf1.
 INFO] Fetching metadata for package translate/ruby-1_9_3-p484_shar version live in smf1.
 INFO] Fetching metadata for package translate/mysql-5_5_23_t6_1 version live in smf1.
 INFO] Checking status of smf1/yhua/devel/uileaderboard_scheduler
 INFO] Active tasks found for job smf1/yhua/devel/uileaderboard_scheduler. Updating existing job
 INFO] Updating job: uileaderboard_scheduler
 INFO] Instances to update: [0]
 INFO] Processing in parallel with 1 worker thread(s)
 INFO] Examining instance: 0
 INFO] Killing instance: 0
 INFO] Killed: 0
 INFO] Adding instance: 0
 INFO] Added: 0
 INFO] Watching instances: [0]
 INFO] Detected RUNNING instance 0
 INFO] Instance 0 has been up and healthy for at least 121 seconds
 INFO] Update successful
 INFO] Response from scheduler: OK (message: None)
 INFO] Job url: https://scheduler-prod-mesos.service.smf1.twitter.biz/scheduler/yhua/devel/uileaderboard_scheduler

I, [2014-09-04T10:22:02.711054 #42719]  INFO -- : App: uileaderboard production branch: master succesfully deployed to http://uileaderboard.devel.yhua.service.smf1.twitter.com
